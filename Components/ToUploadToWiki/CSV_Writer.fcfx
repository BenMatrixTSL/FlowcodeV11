<root>
<document scada='0' projtype='1' schema='103' license='1,82702381,95CJQR' title='' description='' fcversion='720896' target='PIC.16F.16F1937' >
	<config data='!0,fe2!10,1eff%0,2%3,0%5,1%6,1%7,1%8,1%9,3%b,1%c,0%d,0%10,3%14,3%18,0%19,1%1a,1%1c,1%1d,0' clkspd='19660800' simspd='1' usewdt='0' constif='0' Use3V3='0' />
	<plugins >
		<dll_models enabled='1' />
	</plugins>
	<supplement use='0' head='' body='' />
	<debug />
	<traces />
	<ghost >
		<FK2 >
			<data name='FK2D0' port='4294967295' pin='4294967295' />
			<data name='FK2D1' port='4294967295' pin='4294967295' />
			<data name='FK2D2' port='4294967295' pin='4294967295' />
			<data name='FK2D3' port='4294967295' pin='4294967295' />
			<data name='FK2D4' port='4294967295' pin='4294967295' />
			<data name='FK2D5' port='4294967295' pin='4294967295' />
			<data name='FK2D6' port='4294967295' pin='4294967295' />
			<data name='FK2D7' port='4294967295' pin='4294967295' />
			<data name='FK2D8' port='4294967295' pin='4294967295' />
			<data name='FK2D9' port='4294967295' pin='4294967295' />
			<data name='FK2D10' port='4294967295' pin='4294967295' />
			<data name='FK2D11' port='4294967295' pin='4294967295' />
			<data name='FK2D12' port='4294967295' pin='4294967295' />
			<data name='FK2D13' port='4294967295' pin='4294967295' />
			<data name='FK2D14' port='4294967295' pin='4294967295' />
			<data name='FK2D15' port='4294967295' pin='4294967295' />
			<data name='FK2A0' port='4294967295' pin='4294967295' />
			<data name='FK2A1' port='4294967295' pin='4294967295' />
			<data name='FK2A2' port='4294967295' pin='4294967295' />
			<data name='FK2A3' port='4294967295' pin='4294967295' />
			<data name='FK2A4' port='4294967295' pin='4294967295' />
			<data name='FK2A5' port='4294967295' pin='4294967295' />
		</FK2>
		<ICD >
			<data name='AnalogPrescaleValue' value='19' />
			<data name='DigitalSampleRate' value='100000' />
			<data name='BreakpointCount' value='8' />
			<data name='CallStackDepthCount' value='8' />
			<data name='ClockPort' value='1' />
			<data name='ClockPin' value='6' />
			<data name='DataPort' value='1' />
			<data name='DataPin' value='7' />
			<data name='UseDefaultPins' value='1' />
			<data name='WrapEnabled' value='1' />
			<data name='CommsDelayOverridden' value='0' />
			<data name='CommsDelay' value='9' />
			<data name='CalculatedCommsDelay' value='9' />
			<data name='AnalogEB2PrescaleValue' value='2' />
			<data name='DigitalEB2SampleRate' value='100000' />
		</ICD>
		<pins >
			<digital A='0' B='0' C='0' D='0' E='0' F='0' G='0' H='0' I='0' J='0' K='0' L='0' M='0' N='0' O='0' P='0' Q='0' R='0' S='0' T='0' U='0' V='0' W='0' X='0' Y='0' Z='0' />
			<analog A='0' B='0' C='0' D='0' E='0' F='0' G='0' H='0' I='0' J='0' K='0' L='0' M='0' N='0' O='0' P='0' Q='0' R='0' S='0' T='0' U='0' V='0' W='0' X='0' Y='0' Z='0' />
		</pins>
	</ghost>
	<components >
		<settings autoimg='0' center='1' unitscale='0' fixedscale='0' fixedx='1' fixedy='1' fixedz='1' headcode='0' />
		<definition guid='7d0c33a1-0aaa-4250-84bb-f96fc113abac' vstate='40' vmin='0' vmaj='1' srcleaf='CSV_Writer.fcfx' visiblename='CSV Read/Write' description='A component to simplify the task of creating and dumping data to a CSV file that can be loaded
into Microcoft Excel or LibreOffice Math to create nice charts and graphs.
Requires one of the File components to provide access to the file system.' category='File' category2='File ' category3='' bIs2dOnly='1' bIs3dOnly='0' bIsWysiwyg='0' catenable='1' author='Matrix TSL' manuname='' manucode='' sysinfo='17830155' keywords='' dynamic='1' scadaCompatible='1' embeddedCompatible='1' showmacros='1' iconpath='..\..\icons\components\Sheet.png' />
		<component class_type='root' codename='CSV_ReadWrite' panelId='-1' x='0' y='0' z='0' xsz='1' ysz='1' zsz='1' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='0' poslock='0' ancTop='0' ancBottom='0' ancLeft='0' ancRight='0' ancMinX='0' ancMinY='0' comp2dType='0' macronames='$(type)_$(module)__$(macro)' >
			<resources />
			<properties >
				<property name='File Component' target='FileComponent' typeid='17' hidden='1' locked='0' info='File component used to provide access to the file systems.' />
				<property name='LinkTo' target='LibraryComponent1::OutputIcon::LinkTo' typeid='16' hidden='0' locked='0' info='' filter='000' />
			</properties>
			<values >
				<value target='FileComponent' data='' />
				<value target='LibraryComponent1::OutputIcon::LinkTo' data='0' />
			</values>
			<events >
				<event class='Components' event='Initialise' target='Ev_Initialise' />
				<event class='Components' event='Renamed' target='Ev_Renamed' />
				<event class='Components' event='Property' target='Ev_Property' />
				<event class='System' event='LoadComplete' target='Ev_LoadComplete' />
				<event class='Simulation' event='Stop' target='Ev_Stop' />
			</events>
			<apis >
				<api name='CloseFile' alt='CloseFile' type='1' proto='1' />
				<api name='SequentialReadString' alt='SequentialReadString' type='1' proto='1' />
				<api name='AddString' alt='AddString' type='1' proto='1' />
				<api name='ReadAsString' alt='ReadAsString' type='1' proto='1' />
				<api name='SequentialReadNumber' alt='SequentialReadNumber' type='1' proto='1' />
				<api name='AddNumber' alt='AddNumber' type='1' proto='1' />
				<api name='ReadAsNumber' alt='ReadAsNumber' type='1' proto='1' />
				<api name='AddInteger' alt='AddInteger' type='1' proto='1' />
				<api name='SetSequentialIndex' alt='SetSequentialIndex' type='1' proto='1' />
				<api name='OpenFile' alt='OpenFile' type='1' proto='1' />
				<api name='NextRow' alt='NextRow' type='1' proto='1' />
			</apis>
			<variables >
				<variable public='0' >
					<def class_type='variable' name='SequentialIndex' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='FileOpened' type='b1' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='HasRead' type='b1' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='OldSIdx' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='65535' />
				</variable>
			</variables>
			<macros >
				<macro >
					<flowline name='Ev_Stop' description='Broadcast to all components that simulation has stopped' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='CloseFile' />
								<command class_type='calculation' title='Calculation' >
									<exp exp='FileOpened = 0' />
								</command>
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='CloseFile' description='Closes the file and finishes off any pending writes ready for use in an external application.' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='delay' title='Delay' exp='250' type='1' />
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='CloseFile' />
								<command class_type='calculation' title='Calculation' >
									<exp exp='FileOpened = 0' />
								</command>
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SequentialReadString' description='Reads the contents of a cell as a string.
Automatically moved to the next data cell after a read.' statediag='0' >
						<return name='Return' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='2000' />
						</return>
						<local name='Idx' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='Done' type='b1' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='Data' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='1' />
						</local>
						<local name='Elements' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='last' type='b1' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' >
							<exp exp='.Return = &quot;&quot;' />
						</command>
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='FlashRx' />
								<command class_type='calculation' title='Calculation' >
									<exp exp='HasRead = 1' />
								</command>
								<command class_type='decision' title='Decision' exp='SequentialIndex != OldSIdx' swap='0' >
									<flowline >
										<command class_type='calculation' title='Calculation' >
											<exp exp='.Idx = 0' />
											<exp exp='.last = 0' />
										</command>
										<command class_type='loop' title='Loop' type='0' exp='.Idx &lt; SequentialIndex' >
											<flowline >
												<command class_type='decision' title='Decision' exp='.Idx = 0' swap='0' >
													<flowline >
														<command class_type='call' title='Reset read pointer to start of file' component='FATDummy1' macro='ReadByteFromIndex' >
															<return exp='.Data[0]' />
															<argument exp='.Idx' />
														</command>
													</flowline>
													<flowline >
														<command class_type='call' title='Read next byte from file' component='FATDummy1' macro='ReadByteFromFile' >
															<return exp='.Data[0]' />
														</command>
													</flowline>
												</command>
												<command class_type='decision' title='Null' exp='.Data[0] = 0' swap='0' >
													<flowline >
														<command class_type='goto' title='EOF' labelid='0' labelname='' />
													</flowline>
													<flowline >
														<command class_type='decision' title='Decision' exp='.Data[0] = &apos;,&apos;' swap='0' >
															<flowline >
																<command class_type='calculation' title='Next Cell' >
																	<exp exp='.Idx = .Idx + 1' />
																</command>
																<command class_type='calculation' title='Calculation' >
																	<exp exp='.last = 1' />
																</command>
															</flowline>
															<flowline >
																<command class_type='decision' title='Decision' exp='.Data[0] = &apos;\n&apos;' swap='0' >
																	<flowline >
																		<command class_type='decision' title='Decision' exp='.last' swap='0' >
																			<flowline >
																				<command class_type='comment' title='' comment='Skip over &quot;,\n&quot; to avoid two increments' textarea='12,0,12,0' />
																			</flowline>
																			<flowline >
																				<command class_type='calculation' title='Next Cell' >
																					<exp exp='.Idx = .Idx + 1' />
																				</command>
																			</flowline>
																		</command>
																	</flowline>
																	<flowline >
																		<command class_type='calculation' title='Calculation' >
																			<exp exp='.last = 1' />
																		</command>
																	</flowline>
																</command>
															</flowline>
														</command>
													</flowline>
												</command>
												<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='FlashRx' />
											</flowline>
										</command>
									</flowline>
									<flowline />
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Idx = 0' />
									<exp exp='.last = 1' />
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Data[0] = 255' />
								</command>
								<command class_type='loop' title='Loop' type='0' exp='.Data[0] != 0' >
									<flowline >
										<command class_type='label' title='Declare Connection Point' labelid='1' labelname='B' />
										<command class_type='call' title='Read next byte from file' component='FATDummy1' macro='ReadByteFromFile' >
											<return exp='.Data[0]' />
										</command>
										<command class_type='decision' title='Decision' exp='.Data[0] = 0' swap='0' >
											<flowline >
												<command class_type='calculation' title='Calculation' >
													<exp exp='.Data[0] = 0' />
												</command>
											</flowline>
											<flowline >
												<command class_type='decision' title='Decision' exp='.Data[0] = &apos;,&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='Calculation' >
															<exp exp='.Data[0] = 0' />
														</command>
													</flowline>
													<flowline >
														<command class_type='decision' title='Decision' exp='.Data[0] = &apos;\n&apos;' swap='0' >
															<flowline >
																<command class_type='decision' title='Decision' exp='.last = 1' swap='0' >
																	<flowline >
																		<command class_type='calculation' title='Calculation' >
																			<exp exp='.last = 0' />
																		</command>
																		<command class_type='goto' title='Avoid &quot;,\n&quot; double cell' labelid='1' labelname='' />
																	</flowline>
																	<flowline >
																		<command class_type='calculation' title='Calculation' >
																			<exp exp='.Data[0] = 0' />
																		</command>
																	</flowline>
																</command>
															</flowline>
															<flowline >
																<command class_type='calculation' title='Calculation' >
																	<exp exp='.last = 0' />
																</command>
															</flowline>
														</command>
													</flowline>
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Append data to string' >
											<exp exp='.Return[.Idx] = .Data[0]' />
											<exp exp='.Idx = .Idx + 1' />
										</command>
									</flowline>
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='SequentialIndex = SequentialIndex + 1' />
									<exp exp='OldSIdx = SequentialIndex' />
								</command>
								<command class_type='label' title='Declare Connection Point' labelid='0' labelname='A' />
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='AddString' description='Adds a string to the CSV followed by a comma.
This will form a single column of data in the CSV file.' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<param name='data' type='T8*' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='1000' />
						</param>
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='AppendStringToFile' >
									<argument exp='.Data' />
								</command>
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='AppendStringToFile' >
									<argument exp='&quot;,&quot;' />
								</command>
								<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='FlashTx' />
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadAsString' description='Reads the contents of a cell as a string' statediag='0' >
						<return name='Return' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='2000' />
						</return>
						<param name='Column' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='Row' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Idx' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Data' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='2' />
						</local>
						<local name='Address' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='First' type='b1' description='' isconst='0' isHidden='0' isinit='1' usrinit='1' setinit='1' />
						<command class_type='calculation' title='Calculation' >
							<exp exp='.Return = &quot;&quot;' />
						</command>
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='FlashRx' />
								<command class_type='calculation' title='Calculation' >
									<exp exp='HasRead = 1' />
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Idx = 0' />
								</command>
								<command class_type='loop' title='Loop' type='0' exp='.Idx &lt; .Row' >
									<flowline >
										<command class_type='decision' title='Decision' exp='.first = 1' swap='0' >
											<flowline >
												<command class_type='call' title='Component Macro' component='FATDummy1' macro='ReadByteFromIndex' >
													<return exp='.Data[0]' />
													<argument exp='0' />
												</command>
												<command class_type='calculation' title='Calculation' >
													<exp exp='.first = 0' />
												</command>
											</flowline>
											<flowline >
												<command class_type='call' title='Component Macro' component='FATDummy1' macro='ReadByteFromFile' >
													<return exp='.Data[0]' />
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Calculation' >
											<exp exp='.Address = .Address + 1' />
										</command>
										<command class_type='decision' title='Decision' exp='.Data[0] = 0' swap='0' >
											<flowline >
												<command class_type='goto' title='EOF' labelid='0' labelname='' />
											</flowline>
											<flowline >
												<command class_type='decision' title='Decision' exp='.Data[0] = &apos;\n&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='Next Row' >
															<exp exp='.Idx = .Idx + 1' />
														</command>
													</flowline>
													<flowline />
												</command>
											</flowline>
										</command>
									</flowline>
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Idx = 0' />
								</command>
								<command class_type='loop' title='Loop' type='0' exp='.Idx &lt; .Column' >
									<flowline >
										<command class_type='decision' title='Decision' exp='(.idx = 0) &amp;&amp; (.row = 0)' swap='0' >
											<flowline >
												<command class_type='call' title='Component Macro' component='FATDummy1' macro='ReadByteFromIndex' >
													<return exp='.Data[0]' />
													<argument exp='0' />
												</command>
											</flowline>
											<flowline >
												<command class_type='call' title='Component Macro' component='FATDummy1' macro='ReadByteFromFile' >
													<return exp='.Data[0]' />
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Calculation' >
											<exp exp='.Address = .Address + 1' />
										</command>
										<command class_type='decision' title='Decision' exp='.Data[0] = 0' swap='0' >
											<flowline >
												<command class_type='goto' title='EOF' labelid='0' labelname='' />
											</flowline>
											<flowline >
												<command class_type='decision' title='Decision' exp='.Data[0] = &apos;,&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='Next Column' >
															<exp exp='.Idx = .Idx + 1' />
														</command>
													</flowline>
													<flowline >
														<command class_type='decision' title='Decision' exp='.Data[0] = &apos;\n&apos;' swap='0' >
															<flowline >
																<command class_type='goto' title='EOR' labelid='0' labelname='' />
															</flowline>
															<flowline />
														</command>
													</flowline>
												</command>
											</flowline>
										</command>
									</flowline>
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Idx = 0' />
									<exp exp='.Data[0] = 255' />
								</command>
								<command class_type='loop' title='Loop' type='0' exp='.Data[0] != 0' >
									<flowline >
										<command class_type='decision' title='Decision' disable='1' exp='(.idx = 0) &amp;&amp; (.row = 0) &amp;&amp; (.column = 0)' swap='0' >
											<flowline >
												<command class_type='call' title='Component Macro' component='FATDummy1' macro='ReadByteFromIndex' >
													<return exp='.Data[0]' />
													<argument exp='0' />
												</command>
											</flowline>
											<flowline />
										</command>
										<command class_type='call' title='Component Macro' component='FATDummy1' macro='ReadByteFromFile' >
											<return exp='.Data[0]' />
										</command>
										<command class_type='calculation' title='Calculation' >
											<exp exp='.Address = .Address + 1' />
										</command>
										<command class_type='decision' title='Decision' exp='.Data[0] = 0' swap='0' >
											<flowline >
												<command class_type='calculation' title='Calculation' >
													<exp exp='.Data[0] = 0' />
												</command>
											</flowline>
											<flowline >
												<command class_type='decision' title='Decision' exp='.Data[0] = &apos;,&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='Calculation' >
															<exp exp='.Data[0] = 0' />
														</command>
													</flowline>
													<flowline >
														<command class_type='decision' title='Decision' exp='.Data[0] = &apos;\n&apos;' swap='0' >
															<flowline >
																<command class_type='calculation' title='Calculation' >
																	<exp exp='.Data[0] = 0' />
																</command>
															</flowline>
															<flowline />
														</command>
													</flowline>
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Append data to string' >
											<exp exp='.Return[.Idx] = .Data[0]' />
											<exp exp='.Idx = .Idx + 1' />
										</command>
									</flowline>
								</command>
								<command class_type='label' title='Declare Connection Point' labelid='0' labelname='A' />
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Initialise' description='Initialisation routine for the component once the component is linked to its parent' statediag='0' >
						<return name='Return' type='u32' description='Non-zero to prevent initialisation' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='call' title='User Macro' macro='Ev_Property' />
					</flowline>
				</macro>
				<macro >
					<flowline name='SequentialReadNumber' description='Reads the contents of a cell as a number.
Automatically moved to the next data cell after a read.' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='Data' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='call' title='User Macro' macro='SequentialReadString' >
							<return exp='.Data' />
						</command>
						<command class_type='calculation' title='Calculation' >
							<exp exp='.Return = StringToFloat$ (.Data)' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='AddNumber' description='Adds a number to the CSV followed by a comma.
This will form a single column of data in the CSV file.' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<param name='data' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='Str' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Str = FloatToString$ (.data)' />
								</command>
								<command class_type='call' title='Call Macro' macro='AddString' >
									<argument exp='.Str' />
								</command>
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadAsNumber' description='Reads the contents of a cell as a number.' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<param name='Column' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='Row' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Data' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='call' title='User Macro' macro='ReadAsString' >
									<return exp='.Data' />
									<argument exp='.Column' />
									<argument exp='.Row' />
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Return = StringToFloat$ (.Data)' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Return = 0.0' />
								</command>
							</flowline>
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Property' description='Sent when a property has been changed by the User' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Handle' type='h32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='GetLinkHandle' >
							<return exp='.Handle' />
							<argument exp='1' />
						</command>
						<command class_type='sim' title='Component Macro' macro='Component.Property.SetValue' >
							<argument exp='this' />
							<argument exp='&quot;FileComponent&quot;' />
							<argument exp='.Handle' />
						</command>
						<command class_type='sim' title='Built-in Function' macro='System.RedirectMacros' >
							<argument exp='FATDummy1' />
							<argument exp='.Handle' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_LoadComplete' description='Broadcast after a project has finished loading' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='decision' title='Decision' exp='FileComponent' swap='0' >
							<flowline >
								<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='SetLinkHandle' >
									<argument exp='1' />
									<argument exp='FileComponent' />
								</command>
								<command class_type='sim' title='Built-in Function' macro='Component.Property.SetValue' >
									<argument exp='this' />
									<argument exp='&quot;FileComponent&quot;' />
									<argument exp='0' />
								</command>
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Renamed' description='' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Name' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='sim' title='' macro='Tree.GetName' >
							<return exp='.Name' />
							<argument exp='this' />
						</command>
						<command class_type='sim' title='' macro='Component.Property.SetValue' >
							<argument exp='LibraryComponent1' />
							<argument exp='&quot;Name&quot;' />
							<argument exp='.Name' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='AddInteger' description='Adds an integer number to the CSV followed by a comma.
This will form a single column of data in the CSV file.' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<param name='data' type='s32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Str' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Str = ToString$(.data)' />
								</command>
								<command class_type='call' title='Call Macro' macro='AddString' >
									<argument exp='.Str' />
								</command>
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SetSequentialIndex' description='Sets the index for sequential reads.
Index is automatically reset to 0 after a file open.' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<param name='Index' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' >
							<exp exp='SequentialIndex = .Index' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='OpenFile' description='Creates or opens a file ready for streaming data.
If the file already exists then the contents will be deleted and the file started again from scratch. Returns 1 if file found and opened.' statediag='0' >
						<return name='Return' type='b1' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='Filename' type='T8*' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</param>
						<param name='Erase' type='b1' description='0=Append existing data, 1=Reset file data' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Warning' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<local name='Ret' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='decision' title='Decision' exp='.Erase' swap='0' >
							<flowline >
								<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='FlashTx' />
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='DeleteFile' >
									<argument exp='.Filename' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Component Macro' component='FATDummy1' macro='OpenFile' >
							<return exp='.Ret' />
							<argument exp='.Filename' />
						</command>
						<command class_type='decision' title='File Not Found?' exp='.Ret != 0' swap='0' >
							<flowline >
								<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='FlashRx' />
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='CreateFile' >
									<return exp='.Ret' />
									<argument exp='.Filename' />
								</command>
								<command class_type='comment' title='' comment='Delay required here or sim cannot get access to the file until 
second run.' textarea='12,0,12,0' />
								<command class_type='delay' title='Delay' exp='250' type='1' />
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='OpenFile' >
									<return exp='.Ret' />
									<argument exp='.Filename' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='calculation' title='Calculation' >
							<exp exp='HasRead = 0' />
							<exp exp='SequentialIndex = 0' />
							<exp exp='OldSIdx = 65535' />
						</command>
						<command class_type='decision' title='File Not Found?' exp='.Ret != 0' swap='0' >
							<flowline >
								<command class_type='comment' title='' comment='Maybe Write Permissions Problem?' textarea='12,0,12,0' />
								<command class_type='calculation' title='Calculation' >
									<exp exp='FileOpened = 0' />
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='.Warning = &quot;CSV File: &quot; + .Filename + &quot; Not Opened! Please check the filepath and filename are ok and that you have write permissions to the file.&quot;' />
								</command>
								<command class_type='sim' title='Simulation' macro='UI.SimpleMsgBox' >
									<argument exp='.Warning' />
								</command>
							</flowline>
							<flowline >
								<command class_type='decision' title='Decision' exp='.Erase' swap='0' >
									<flowline />
									<flowline >
										<command class_type='call' title='Call Macro' macro='NextRow' />
										<command class_type='call' title='Call Macro' macro='NextRow' />
									</flowline>
								</command>
								<command class_type='calculation' title='Calculation' >
									<exp exp='FileOpened = 1' />
								</command>
							</flowline>
						</command>
						<command class_type='calculation' title='Calculation' >
							<exp exp='.Return = FileOpened' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='NextRow' description='Move to the next row in the file' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<local name='str' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='decision' title='Decision' exp='FileOpened' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' >
									<exp exp='.str = &quot;\r\n&quot;' />
								</command>
								<command class_type='call' title='Component Macro' component='FATDummy1' macro='AppendStringToFile' >
									<argument exp='.str' />
								</command>
								<command class_type='sim' title='Component Macro' component='LibraryComponent1' macro='FlashTx' />
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Main' description='' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
					</flowline>
				</macro>
			</macros>
			<component class_type='ref' guid='58be670e-18fb-477e-ab09-61fde14b23ec' vmin='0' vmaj='1' codename='LibraryComponent1' panelId='-1' x='0' y='0' z='0' xsz='100' ysz='100' zsz='100' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='1' poslock='1' ancTop='0' ancBottom='0' ancLeft='0' ancRight='0' ancMinX='0' ancMinY='0' comp2dType='0' >
				<resources />
				<properties />
				<values >
					<value target='Text::sText' data='CSV
Read/Write' />
					<value target='Name' data='' />
					<value target='Peripheral::sText' data='' />
					<value target='Text::nVerticalAlignment' data='002' />
					<value target='ShowComms' data='1' />
					<value target='InputIcon::CommsType' data='255' />
					<value target='InputIcon::LinkTo' data='0' />
					<value target='IconsOnRight' data='0' />
					<value target='OutputIcon::CommsType' data='003' />
					<value target='OutputIcon::LinkTo' data='0' />
					<value target='InputIcon1::CommsType' data='255' />
					<value target='ConsoleHandle' data='0' />
					<value target='Upgraded' data='0' />
				</values>
				<events />
				<apis />
				<variables />
				<macros />
			</component>
			<component class_type='ref' guid='ad93b885-8e97-425d-a7d0-c426d6e40ec3' vmin='7' vmaj='2' codename='FATDummy1' panelId='-1' x='0' y='0' z='0' xsz='0.1' ysz='0.1' zsz='0.1' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='0' scadavisible='1' interactive='1' solid='1' layer='1' poslock='0' ancTop='0' ancBottom='0' ancLeft='0' ancRight='0' ancMinX='0' ancMinY='0' comp2dType='0' >
				<resources />
				<properties />
				<values />
				<events />
				<apis />
				<variables />
				<macros />
			</component>
		</component>
	</components>
	<scadaresourcelookup />
	<keymap />
	<panel2d shadows='0' lighting='2' brightness='-25' >
		<background rgb='8882055' img='' style='0' />
		<camera xe='13.691' ye='-17.8606' ze='529.248' xt='13.691' yt='-17.8606' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<viewport dx='527' dy='782' zoom='120.486' fix_topleft='0' />
		<page x='1000' y='1000' show='0' rgb='0' />
		<winpos ID='7005' RectRecentFloat='1391,-321,1639,-27' RectRecentDocked='942,141,1489,1013' RecentFrameAlignment='16384' RecentRowIndex='0' IsFloating='0' MRUWidth='32767' PinState='0' IsMaximized='0' IsVisible='1' />
	</panel2d>
	<panel3d shadows='0' lighting='0' brightness='-51' perspective='1' >
		<background rgb='8409120' img='' style='5' />
		<table rgb='7360576' img='' style='0' size='0' />
		<camera xe='0.758766' ye='1.19831' ze='77.1954' xt='0.758766' yt='1.19831' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<camerakey0 xe='0' ye='0' ze='300' xt='0' yt='0' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<camerakey1 xe='-3.67394e-14' ye='0' ze='-300' xt='0' yt='0' zt='0' xquat='0' yquat='1' zquat='0' wquat='6.12323e-17' />
		<camerakey2 xe='0' ye='-300' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.707107' yquat='0' zquat='0' wquat='0.707107' />
		<camerakey3 xe='-3.67394e-14' ye='300' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-4.32978e-17' yquat='0.707107' zquat='0.707107' wquat='4.32978e-17' />
		<camerakey4 xe='-300' ye='-6.66134e-14' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.5' yquat='0.5' zquat='0.5' wquat='0.5' />
		<camerakey5 xe='300' ye='-6.66134e-14' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.5' yquat='-0.5' zquat='-0.5' wquat='0.5' />
		<camerakey6 xe='-173.205' ye='-173.205' ze='173.205' xt='0' yt='0' zt='0' xquat='-0.424708' yquat='0.17592' zquat='0.339851' wquat='0.820473' />
		<winpos ID='7004' RectRecentFloat='0,425,654,1002' RectRecentDocked='0,0,317,864' RecentFrameAlignment='16384' RecentRowIndex='0' IsFloating='0' MRUWidth='32767' PinState='0' IsMaximized='0' IsVisible='0' />
	</panel3d>
	<panels2d count='0' />
	<layout >
		<view type='0' name='OpenFile' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='CloseFile' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='NextRow' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Stop' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='AddString' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='AddNumber' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Main' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadAsString' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadAsNumber' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SetSequentialIndex' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SequentialReadString' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SequentialReadNumber' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Initialise' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Property' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_LoadComplete' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='AddInteger' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAZgIAAGMDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
	</layout>
</document>
</root>
