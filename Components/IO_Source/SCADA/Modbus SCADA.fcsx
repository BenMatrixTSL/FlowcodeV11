<root>
<document scada='1' panel2DSCADA='0' panel3DSCADA='6' panelPropsSCADA='0' panelConsoleSCADA='0' panelDataRecorderSCADA='0' panel2DCount='0' playbackSCADA='0' ShouldAutoStartSCADA='0' ShouldLockCameraSCADA='0' ShouldBundleSCADA='1' SCADAProgramTitle='' schema='103' license='1,CompMaker,PWKUUN' title='' description='' fcversion='655360' target='SCADA.SCADA.GENERIC' >
	<config data='' clkspd='100000000' simspd='1' usewdt='0' constif='0' Use3V3='0' />
	<plugins >
		<dll_models enabled='1' />
	</plugins>
	<supplement use='0' head='' body='' />
	<debug />
	<traces />
	<ghost >
		<FK2 >
			<data name='FK2D0' port='4294967295' pin='4294967295' />
			<data name='FK2D1' port='4294967295' pin='4294967295' />
			<data name='FK2D2' port='4294967295' pin='4294967295' />
			<data name='FK2D3' port='4294967295' pin='4294967295' />
			<data name='FK2D4' port='4294967295' pin='4294967295' />
			<data name='FK2D5' port='4294967295' pin='4294967295' />
			<data name='FK2D6' port='4294967295' pin='4294967295' />
			<data name='FK2D7' port='4294967295' pin='4294967295' />
			<data name='FK2D8' port='4294967295' pin='4294967295' />
			<data name='FK2D9' port='4294967295' pin='4294967295' />
			<data name='FK2D10' port='4294967295' pin='4294967295' />
			<data name='FK2D11' port='4294967295' pin='4294967295' />
			<data name='FK2D12' port='4294967295' pin='4294967295' />
			<data name='FK2D13' port='4294967295' pin='4294967295' />
			<data name='FK2D14' port='4294967295' pin='4294967295' />
			<data name='FK2D15' port='4294967295' pin='4294967295' />
			<data name='FK2A0' port='4294967295' pin='4294967295' />
			<data name='FK2A1' port='4294967295' pin='4294967295' />
			<data name='FK2A2' port='4294967295' pin='4294967295' />
			<data name='FK2A3' port='4294967295' pin='4294967295' />
			<data name='FK2A4' port='4294967295' pin='4294967295' />
			<data name='FK2A5' port='4294967295' pin='4294967295' />
		</FK2>
		<ICD >
			<data name='AnalogPrescaleValue' value='19' />
			<data name='DigitalSampleRate' value='100000' />
			<data name='BreakpointCount' value='8' />
			<data name='CallStackDepthCount' value='8' />
			<data name='ClockPort' value='4095' />
			<data name='ClockPin' value='0' />
			<data name='DataPort' value='4095' />
			<data name='DataPin' value='0' />
			<data name='UseDefaultPins' value='1' />
			<data name='WrapEnabled' value='1' />
			<data name='CommsDelayOverridden' value='0' />
			<data name='CommsDelay' value='2' />
			<data name='CalculatedCommsDelay' value='2' />
			<data name='AnalogEB2PrescaleValue' value='2' />
			<data name='DigitalEB2SampleRate' value='100000' />
		</ICD>
		<pins >
			<digital A='0' B='0' C='0' D='0' E='0' F='0' G='0' H='0' I='0' J='0' K='0' L='0' M='0' N='0' O='0' P='0' Q='0' R='0' S='0' T='0' U='0' V='0' W='0' X='0' Y='0' Z='0' />
			<analog A='0' B='0' C='0' D='0' E='0' F='0' G='0' H='0' I='0' J='0' K='0' L='0' M='0' N='0' O='0' P='0' Q='0' R='0' S='0' T='0' U='0' V='0' W='0' X='0' Y='0' Z='0' />
		</pins>
	</ghost>
	<components >
		<settings autoimg='0' center='1' unitscale='1' fixedscale='0' fixedx='1' fixedy='1' fixedz='1' headcode='0' />
		<definition guid='97647329-1e06-46dc-ba11-9d721038294d' vstate='40' vmin='1' vmaj='2' srcleaf='Modbus SCADA.fcsx' visiblename='Modbus Master (SCADA)' description='Modbus component for talking to Modbus compatible hardware via RS232 or RS485. ' category='Comms: System' category2='' category3='' bIs2dOnly='1' bIs3dOnly='0' catenable='1' author='Matrix TSL' manuname='' manucode='' sysinfo='3150091' keywords='' dynamic='1' scadaCompatible='1' embeddedCompatible='0' showmacros='1' iconpath='..\..\icons\components\Modbus.png' />
		<component class_type='root' codename='ModbusMasterSCADA' panelId='-1' x='0' y='0' z='0' xsz='1' ysz='1' zsz='1' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='0' poslock='0' comp2dType='0' >
			<resources />
			<properties >
				<property name='Modbus Properties' folder='property_2' hidden='0' >
					<property name='Frame Type' target='FrameType' typeid='16' hidden='0' locked='0' info='Switches between RTU and ASCII forms of Modbus' filter='000Modbus RTU
001Modbus ASCII' />
					<property name='Receive Buffer Size' target='ReceiveBufferSize' typeid='21' hidden='0' locked='0' info='Maximum number of bytes the receive buffer can hold' />
					<property name='Slave ID Bytes' target='AddressBytes' typeid='21' hidden='0' locked='0' info='Number of bytes used when passing a slave ID, usually 1 but sometimes 2' />
					<property name='Silent Interval' target='SilentInterval' typeid='21' hidden='0' locked='0' info='Configures how much time to wait after each master modbus command before another command can be sent.
A silent interval of 60ms minimum is required in order to guarentee successful reception of the next transmission.
0=No Delay 
60 = 60mS - Default
Range : 0 - 65535' />
					<property name='UART Receive Timeout' target='RXTOUT' typeid='21' hidden='0' locked='0' info='Amount of time to wait before timing out when listening for a slave&apos;s response.
Range: 0 - 255.
0 = Don&apos;t Wait
1 - 254 = X ms
255 = Wait Forever' />
					<property name='Receive Timeout Count' target='TOUTCNT' typeid='21' hidden='0' locked='0' info='Number of timeouts in a row to wait for until we decide the slave is not responding or finished responding
to a message.
Range: 0 - 255
0 = First Timeout Only
1 = First Timeout + 1
2 = First Timeout + 2' />
				</property>
				<property name='Runtime Properties' folder='property_3' hidden='0' >
					<property name='Label' target='label' typeid='10' hidden='0' locked='0' info='A text label to appear on the Modbus panel object.' />
					<property name='Console Data' target='scada_uart1::ConsoleData' typeid='7' hidden='0' locked='0' info='Selects if the console data is automatically generated or not' />
					<property name='Console Columns' target='scada_uart1::ConsoleColumns' typeid='21' hidden='0' locked='0' info='Number of characters that can be displayed on a single line of the console.' />
					<property name='Data Source' target='scada_uart1::DataSource' typeid='16' hidden='0' locked='0' info='Simulation data source used to allow the component to connect to various remote devices
    Nothing - Simulation data is ignored
    COM port - Routes the communication data to and from a physical or virtual COM port 
    Injector - Routes the communication data via a data injector component on the Panel.' filter='000Nothing
001COM Port
002Data Injector' />
					<property name='COM Port' target='scada_uart1::com_port' typeid='16' hidden='0' locked='0' info='Lists all the current available COM port hardware on your PC.' />
					<property name='Refresh Ports' target='scada_uart1::RefreshPorts' typeid='7' hidden='0' locked='0' info='' />
					<property name='Baud Rate' target='scada_uart1::baud' typeid='21' hidden='0' locked='0' info='COM port data rate in bits per second' />
					<property name='API' target='scada_uart1::Injector' typeid='16' hidden='1' locked='0' info='Selects which injector component to route the communication data via.
Add injector components to the panel before they will be available in this list.
Injector components are available from the Comms component category.' filter='000' />
				</property>
			</properties>
			<values >
				<value target='FrameType' data='000' />
				<value target='ReceiveBufferSize' data='20' />
				<value target='AddressBytes' data='1' />
				<value target='SilentInterval' data='60' />
				<value target='RXTOUT' data='220' />
				<value target='TOUTCNT' data='2' />
				<value target='label' data='Modbus' />
				<value target='scada_uart1::ConsoleData' data='' />
				<value target='scada_uart1::ConsoleColumns' data='64' />
				<value target='scada_uart1::DataSource' data='001' />
				<value target='scada_uart1::com_port' data='001' />
				<value target='scada_uart1::RefreshPorts' data='0' />
				<value target='scada_uart1::baud' data='9600' />
				<value target='scada_uart1::Injector' data='' />
			</values>
			<events >
				<event class='Components' event='Initialise' target='Ev_Initialise' />
				<event class='Components' event='Renamed' target='Ev_Renamed' />
				<event class='Components' event='Property' target='Ev_Property' />
			</events>
			<apis >
				<api name='ReadHoldingRegister' alt='ReadHoldingRegister' type='1' proto='1' />
				<api name='ReadCoil' alt='ReadCoil' type='1' proto='1' />
				<api name='SetCoil' alt='SetCoil' type='1' proto='1' />
				<api name='GetResponse' alt='GetResponse' type='1' proto='1' />
				<api name='SetCoils' alt='SetCoils' type='1' proto='1' />
				<api name='GetResponseByte' alt='GetResponseByte' type='1' proto='1' />
				<api name='ChangeFrameType' alt='ChangeFrameType' type='1' proto='1' />
				<api name='GetResponseInt' alt='GetResponseInt' type='1' proto='1' />
				<api name='SetHoldingRegisters' alt='SetHoldingRegisters' type='1' proto='1' />
				<api name='ReadAnalogInput' alt='ReadAnalogInput' type='1' proto='1' />
				<api name='SetHoldingRegister' alt='SetHoldingRegister' type='1' proto='1' />
				<api name='ReadDigitalInput' alt='ReadDigitalInput' type='1' proto='1' />
				<api name='Initialise' alt='Initialise' type='1' proto='1' />
			</apis>
			<variables >
				<variable public='0' >
					<def class_type='variable' name='FrameTypeVar' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='ConsoleHandle' type='h32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='Sum' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='ResponseBuffer' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
						<array size='50' />
					</def>
				</variable>
			</variables>
			<macros >
				<macro >
					<flowline name='Ev_Timer' description='Called back on the panel command System.TimerStart' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='TimerID' type='u32' description='The identifier passed to the System.TimerStart panel command' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadHoldingRegister' description='This command requests the analogue holding register values starting from the start RegAddress and going through to RegAddress plus RegCount.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegAddress' type='u16' description='Address: 0=40001, 1=40002, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegCount' type='u16' description='Number of consecutive registers to read, starting from RegAddress' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadHoldingRegister -&gt; SlaveID:&quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x03' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING (.RegAddress + 40001)' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; RegisterCount:&quot; + STRING .RegCount' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Read Holding Register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x03' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Initialise' description='Initialisation routine for the component once the component is linked to its parent' statediag='0' >
						<return name='Return' type='u32' description='Non-zero to prevent initialisation' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='TempStr' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='comment' title='' comment='Setup Modbus Console Tab' textarea='12,0,12,0' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' />
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Ev_Property' />
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadCoil' description='This command requests the ON/OFF status of discrete coils starting from the start CoilAddress and going through to CoilAddress plus CoilCount.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CoilAddress' type='u16' description='Coil Address: 0=Coil1, 1=Coil2, 2=Coil3, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CoilCount' type='u16' description='Number of consecutive coils to try and read' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadCoil -&gt; SlaveID:&quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x01' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING .CoilAddress' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; CoilCount:&quot; + STRING .CoilCount' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Read Coil Status' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x01' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of coils to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of coils to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SetCoil' description='This command writes the contents of a discrete coil at the location CoilAddress.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CoilAddress' type='u16' description='Coil Address: 0=Coil1, 1=Coil2, 2=Coil3, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CoilState' type='u8' description='0=Off, 1=On' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;SetCoil -&gt; SlaveID:&quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x05' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING .CoilAddress' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Force Single Coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x05' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.CoilState' swap='0' >
							<flowline >
								<command class_type='call' title='On = 0xFF00' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='0xFF' />
									<argument exp='.CRC' />
								</command>
								<command class_type='call' title='' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='0x00' />
									<argument exp='.CRC' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; State:On&quot;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='call' title='Off = 0x0000' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='0x00' />
									<argument exp='.CRC' />
								</command>
								<command class_type='call' title='' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='0x00' />
									<argument exp='.CRC' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; State:Off&quot;' />
								</command>
							</flowline>
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='GetResponse' description='Collects as much incoming data as possible and stored into the response buffer. The number of bytes received will be stored into location 0 of the response buffer.
Return value indicates validity of incoming CRC. 0 = OK, 1 = CRC fail, 255 = No Data' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='in' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Index' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<local name='Bit' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRCTest' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='TCnt' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Index2' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Str' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='2' />
						</local>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;\n  &quot;' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;Reply -&gt; &quot;' />
						</command>
						<command class_type='calculation' title='No Data Received Yet' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='ResponseBuffer[0] = 0' />
						</command>
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.TCnt = 0' />
						</command>
						<command class_type='sim' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Receive' >
							<return exp='.in' />
							<argument exp='RXTOUT' />
						</command>
						<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index &lt; ReceiveBufferSize' start='0' >
							<flowline >
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.in &lt; 256' swap='0' >
									<flowline >
										<command class_type='sim' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.TCnt = 0' />
										</command>
										<command class_type='calculation' title='Increment data received counter' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[0] = ResponseBuffer[0] + 1' />
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Index = .Index + 1' />
										</command>
										<command class_type='calculation' title='Add received data to buffer' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[.Index] = .in' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar' swap='0' >
											<flowline >
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.in &gt; 13' swap='0' >
													<flowline >
														<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.Str[0] = .in' />
															<exp exp='.Str[1] = 0' />
														</command>
														<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
															<argument exp='ConsoleHandle' />
															<argument exp='.str' />
														</command>
													</flowline>
													<flowline />
												</command>
											</flowline>
											<flowline >
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='STRING .in + &quot;,&quot;' />
												</command>
											</flowline>
										</command>
									</flowline>
									<flowline >
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.TCnt = TOUTCNT' swap='0' >
											<flowline >
												<command class_type='goto' title='Goto Connection Point' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' labelid='0' labelname='' />
											</flowline>
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.TCnt = .TCnt + 1' />
												</command>
											</flowline>
										</command>
									</flowline>
								</command>
								<command class_type='sim' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Receive' >
									<return exp='.in' />
									<argument exp='1' />
								</command>
							</flowline>
						</command>
						<command class_type='label' title='Connection Point' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' labelid='0' labelname='A' />
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar' swap='0' >
							<flowline >
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[0] &gt;= 4' swap='0' >
									<flowline >
										<command class_type='calculation' title='Remove &apos;:&apos; and Line End from incoming data size' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[0] = ResponseBuffer[0] - 2' />
											<exp exp='ResponseBuffer[0] = (ResponseBuffer[0] / 2) + 1' />
											<exp exp='' />
										</command>
										<command class_type='calculation' title='Skip over &apos;:&apos;' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Index = 2' />
											<exp exp='.Index2 = 1' />
											<exp exp='.Bit = 0' />
										</command>
										<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index2 &lt; ResponseBuffer[0]' >
											<flowline >
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[.Index] &gt; &apos;9&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index] - &apos;A&apos;' />
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] + 10' />
														</command>
													</flowline>
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index] - &apos;0&apos;' />
														</command>
													</flowline>
												</command>
												<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] &lt;&lt; 4' />
												</command>
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Index = .Index + 1' />
												</command>
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[.Index] &gt; &apos;9&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] | (ResponseBuffer[.Index] - &apos;A&apos;)' />
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] + 10' />
														</command>
													</flowline>
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] | (ResponseBuffer[.Index] - &apos;0&apos;)' />
														</command>
													</flowline>
												</command>
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Index2 &lt; (ResponseBuffer[0] - 1)' swap='0' >
													<flowline >
														<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.Bit = .Bit + ResponseBuffer[.Index2]' />
														</command>
													</flowline>
													<flowline />
												</command>
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Index = .Index + 1' />
													<exp exp='.Index2 = .Index2 + 1' />
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Bit = (~ .Bit) + 1' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Bit = ResponseBuffer[.Index2 - 1]' swap='0' >
											<flowline >
												<command class_type='calculation' title='CRC Correct' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 0' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; LRC:OK&quot;' />
												</command>
											</flowline>
											<flowline >
												<command class_type='calculation' title='CRC Fail' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 1' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; LRC:Fail &quot; + NumberToHex$(.Bit) + &quot;:&quot; + NumberToHex$(ResponseBuffer[.Index])' />
												</command>
											</flowline>
										</command>
									</flowline>
									<flowline >
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Return = 255' />
										</command>
										<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
											<argument exp='ConsoleHandle' />
											<argument exp='&quot;Timeout&quot;' />
										</command>
									</flowline>
								</command>
							</flowline>
							<flowline >
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[0] &gt;= 2' swap='0' >
									<flowline >
										<command class_type='calculation' title='Remove CRC from incoming data size' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[0] = ResponseBuffer[0] - 2' />
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Index = 0' />
										</command>
										<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index &lt; ResponseBuffer[0]' >
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Index = .Index + 1' />
												</command>
												<command class_type='calculation' title='XOR DataByte with CRC' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.CRC = .CRC ^ ResponseBuffer[.Index]' />
												</command>
												<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' type='2' exp='8' >
													<flowline >
														<command class_type='calculation' title='Read LS bit' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.Bit = .CRC &amp; 0x01' />
														</command>
														<command class_type='calculation' title='Shift CRC by one place' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.CRC = .CRC &gt;&gt; 1' />
														</command>
														<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Bit' swap='0' >
															<flowline >
																<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
																	<exp exp='.CRC = .CRC ^ 0xA001' />
																</command>
															</flowline>
															<flowline />
														</command>
													</flowline>
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.CRCTest = (ResponseBuffer[.Index] &lt;&lt; 8) + ResponseBuffer[.Index + 1]' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='(.CRCTest &amp; 0xFF) = (.CRC &amp; 0xFF)' swap='0' >
											<flowline >
												<command class_type='calculation' title='CRC Correct' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 0' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; CRC:OK&quot;' />
												</command>
											</flowline>
											<flowline >
												<command class_type='calculation' title='CRC Fail' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 1' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; CRC:Fail &quot; + NumberToHex$(.CRCTest) + &quot;:&quot; + NumberToHex$(.CRC)' />
												</command>
											</flowline>
										</command>
									</flowline>
									<flowline >
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Return = 255' />
										</command>
										<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
											<argument exp='ConsoleHandle' />
											<argument exp='&quot;Timeout&quot;' />
										</command>
									</flowline>
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;\n&quot;' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='SilentInterval &gt; 0' swap='0' >
							<flowline >
								<command class_type='delay' title='Delay' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='SilentInterval' type='1' />
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SetCoils' description='This command writes the contents of a series of discrete coils at the location starting at CoilAddress through to CoilAddress + CoilCount.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CoilAddress' type='u16' description='Coil Address: 0=Coil1, 1=Coil2, 2=Coil3, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CoilCount' type='u16' description='Number of consecutive coils to try and read' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CoilData' type='u8' description='An array of bytes each containing 8 1-bit coil values' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='10' />
						</param>
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<local name='ByteCount' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Index' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='decision' title='Count is a multiple of 8' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='(.CoilCount &amp; 0x07) = 0' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.ByteCount = .CoilCount / 8' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.ByteCount = (.CoilCount / 8) + 1' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;SetCoils -&gt; SlaveID:&quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x0F' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING .CoilAddress' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; CoilCount:&quot; + STRING .CoilCount' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; ByteCount:&quot; + STRING .ByteCount' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Data:&quot;' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Force Multiple Coils' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x0F' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of Coils' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of Coils' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.CoilCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Send Byte Count' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.ByteCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index &lt; .ByteCount' >
							<flowline >
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='NumberToHex$(.CoilData[.Index])' />
								</command>
								<command class_type='call' title='Send Byte Count' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.CoilData[.Index]' />
									<argument exp='.CRC' />
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Index = .Index + 1' />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Index &lt; .ByteCount' swap='0' >
									<flowline >
										<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
											<argument exp='ConsoleHandle' />
											<argument exp='&quot;,&quot;' />
										</command>
									</flowline>
									<flowline />
								</command>
							</flowline>
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='GetResponseByte' description='Reads a byte from the last received response. The Index parametes specifies which byte to read back.
' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='Index' type='u8' description='0=NumBytes, 1=SlaveAddress, 2=FunctionCode/ExceptionCode, 3=DataBytes, 4=data0, 5=data1, ..' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Return = ResponseBuffer[.Index]' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Property' description='Sent when a property has been changed by the User' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Temp_Str' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<local name='Bval' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &lt; 1' swap='0' >
							<flowline >
								<command class_type='sim' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
									<argument exp='this' />
									<argument exp='&quot;AddressBytes&quot;' />
									<argument exp='1' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 2' swap='0' >
							<flowline >
								<command class_type='sim' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
									<argument exp='this' />
									<argument exp='&quot;AddressBytes&quot;' />
									<argument exp='2' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='comment' title='' comment='Work out delay for a byte at current BAUD' textarea='12,0,12,0' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.GetValue' >
							<return exp='.Temp_Str' />
							<argument exp='scada_uart1' />
							<argument exp='&quot;COMPort1::baud_rate&quot;' />
						</command>
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Bval = StringToInt$ (.Temp_Str)' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
							<argument exp='this' />
							<argument exp='&quot;BaudByteDelay&quot;' />
							<argument exp='(1000000 / .BVal) * 10' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.AddText' >
							<return exp='ConsoleHandle' />
							<argument exp='&quot;Modbus Data&quot;' />
							<argument exp='0' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='SetConsoleHandle' >
							<argument exp='ConsoleHandle' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ChangeFrameType' description='Default frame type is the type set in the component properties.' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<param name='Type' type='u8' description='0 = Modbus RTU / 1 = Modbus ASCII' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='FrameTypeVar = .Type' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Renamed' description='' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Name' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='sim' title='' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Tree.GetName' >
							<return exp='.Name' />
							<argument exp='this' />
						</command>
						<command class_type='sim' title='' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
							<argument exp='LibraryComponent1' />
							<argument exp='&quot;Name&quot;' />
							<argument exp='.Name' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SendValueAsASCII' description='' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<param name='Value' type='u8' description='Value to break up into ASCII characters' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Character' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Character = (.Value &amp; 0xF0) &gt;&gt; 4' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Character &gt; 9' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character - 10' />
									<exp exp='.Character = .Character + &apos;A&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character + &apos;0&apos;' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Send MS bits' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
							<argument exp='.Character' />
						</command>
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Character = .Value &amp; 0x0F' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Character &gt; 9' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character - 10' />
									<exp exp='.Character = .Character + &apos;A&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character + &apos;0&apos;' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Send LS bits' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
							<argument exp='.Character' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_GetVarSize' description='Sent to a component to amend the size of the expected array' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='VarName' type='T8' description='The original Flowcode variable' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</param>
						<param name='Elements' type='u32*' description='The number of elements in the array' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='comp' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.comp = Compare$ (.VarName,&quot;ResponseBuffer&quot;,1)' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.comp = 0' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Elements = ReceiveBufferSize' />
								</command>
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='GetResponseInt' description='Reads a 16-bit value from the last received response. 
The Index parametes specifies the byte index of the value to read back.
' statediag='0' >
						<return name='Return' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='Index' type='u8' description='4=data0, 6=data1, 8=data2, ..' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Return = ResponseBuffer[.Index] &lt;&lt; 8' />
							<exp exp='.Return = .Return | ResponseBuffer[.Index + 1]' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SetHoldingRegisters' description='This command writes the contents of several holding registers starting at the location RegAddress through to location RegAddress + RegCount .
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegAddress' type='u16' description='Address: 0=40001, 1=40002, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegCount' type='u16' description='Number of consecutive registers to write, starting from RegAddress' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegValue' type='u16' description='Array of values to send to the registers' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' >
							<array size='10' />
						</param>
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<local name='ByteCount' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Index' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;SetHoldingRegisters -&gt; SlaveID:&quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x10' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; RegCount:&quot; + STRING .RegCount' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Preset Multiple Registers' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x10' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register addres' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register addres' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register Count' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register Count' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.ByteCount = .RegCount * 2' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; ByteCount:&quot; + STRING .ByteCount' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Data:&quot;' />
						</command>
						<command class_type='call' title='Byte Count' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.ByteCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index &lt; .RegCount' >
							<flowline >
								<command class_type='call' title='Send Data' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.RegValue[.Index] &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
								<command class_type='call' title='Send Data' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.RegValue[.Index]' />
									<argument exp='.CRC' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='STRING .RegValue[.Index]' />
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Index = .Index + 1' />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Index &lt; .RegCount' swap='0' >
									<flowline >
										<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
											<argument exp='ConsoleHandle' />
											<argument exp='&quot;,&quot;' />
										</command>
									</flowline>
									<flowline />
								</command>
							</flowline>
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadAnalogInput' description='This command requests the analogue input register values starting from the start RegAddress and going through to RegAddress plus RegCount.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegAddress' type='u16' description='Input Address: 0=10001, 1=10002, 2=10003, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegCount' type='u16' description='Number of consecutive inputs to read, starting from RegAddress' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadAnalogInput -&gt; SlaveID: &quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x04' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING (.RegAddress + 30001)' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; RegCount:&quot; + STRING .RegCount' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Read Input Register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x04' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SetHoldingRegister' description='This command writes the contents of a holding register at the location RegAddress.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegAddress' type='u16' description='Address: 0=40001, 1=40002, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegValue' type='u16' description='Value to send to the selected register' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;SetHoldingRegister -&gt; SlaveID:&quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x06' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING (.RegAddress + 40001)' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Data:&quot; + STRING .RegValue' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Preset Single Register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x06' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register addres' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register addres' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register Value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegValue &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register Value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegValue' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SendAndCalcCRC16' description='Transmits a databyte to the bus and calculates the current value of the CRC, returns the CRC updated with the new data byte.' statediag='0' >
						<return name='Return' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='DataByte' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CRC16' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Bit' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='sim' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashTx' />
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='.DataByte' />
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = Sum + .DataByte' />
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 0' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='XOR DataByte with CRC' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.CRC16 = .CRC16 XOR .DataByte' />
								</command>
								<command class_type='sim' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.DataByte' />
								</command>
								<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' type='2' exp='8' >
									<flowline >
										<command class_type='calculation' title='Read LS bit' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Bit = .CRC16 &amp; 0x01' />
										</command>
										<command class_type='calculation' title='Shift CRC by one place' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.CRC16 = .CRC16 &gt;&gt; 1' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='.Bit' swap='0' >
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.CRC16 = .CRC16 &amp; 0x7FFF' />
													<exp exp='.CRC16 = .CRC16 XOR 0xA001' />
												</command>
											</flowline>
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.CRC16 = .CRC16 &amp; 0x7FFF' />
												</command>
											</flowline>
										</command>
									</flowline>
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = .CRC16' />
								</command>
							</flowline>
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadDigitalInput' description='This command requests the ON/OFF status of discrete inputs starting from the start DataAddress and going through to DataAddress plus DataCount.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='DataAddress' type='u16' description='Input Address: 0=10001, 1=10002, 2=10003, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='DataCount' type='u16' description='Number of consecutive inputs to read, starting from RegAddress' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadDigitalInput -&gt; SlaveID:&quot; + STRING .SlaveID + &quot; FunctionCode:&quot; + STRING 0x02' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING (.DataAddress + 10001)' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; InputCount:&quot; + STRING .DataCount' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='sim' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Read Input Status' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x02' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.DataAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first coil' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.DataAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of coils to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.DataCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of coils to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.DataCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='sim' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='sim' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Main' description='' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
					</flowline>
				</macro>
				<macro >
					<flowline name='Initialise' description='Starts up the UART to allow communications' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='FrameTypeVar = FrameType' />
						</command>
						<command class_type='sim' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='scada_uart1' macro='Init' />
					</flowline>
				</macro>
			</macros>
			<component class_type='ref' guid='a7c1210d-3637-4a18-a6b3-9414ee73b179' vmin='1' vmaj='2' codename='scada_uart1' panelId='-1' x='-0.725711' y='6.21968' z='2126.75' xsz='0.2' ysz='0.2' zsz='0.2' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='1' poslock='0' comp2dType='0' >
				<resources />
				<properties />
				<values >
					<value target='UseUART' data='1' />
					<value target='ConsoleData' data='1' />
					<value target='ConsoleColumns' data='64' />
					<value target='COMPort1::AutoClose' data='1' />
					<value target='DataSource' data='001' />
					<value target='com_port' data='001' />
					<value target='RefreshPorts' data='0' />
					<value target='baud' data='9600' />
					<value target='Injector' data='' />
					<value target='InjectorHandle' data='0' />
					<value target='InjectorChannel' data='0' />
					<value target='APIUseDDR' data='0' />
					<value target='APIDDRPin' data='0' />
					<value target='APIUseFC' data='' />
					<value target='APICTSPin' data='0' />
					<value target='APIRTSPin' data='' />
					<value target='APIDDRRXState' data='000' />
					<value target='BitDelay' data='0' />
					<value target='ParentName' data='ModbusMasterSCADA' />
					<value target='CompName' data='' />
				</values>
				<events />
				<apis />
				<variables />
				<macros />
			</component>
			<component class_type='ref' guid='58be670e-18fb-477e-ab09-61fde14b23ec' vmin='0' vmaj='1' codename='LibraryComponent1' panelId='-1' x='0' y='0' z='0' xsz='100' ysz='100' zsz='100' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='1' poslock='1' comp2dType='0' >
				<resources />
				<properties />
				<values >
					<value target='Text::sText' data='Modbus' />
					<value target='Name' data='' />
					<value target='Peripheral::sText' data='' />
					<value target='Text::nVerticalAlignment' data='002' />
					<value target='ShowComms' data='1' />
					<value target='InputIcon::CommsType' data='255' />
					<value target='InputIcon::LinkTo' data='0' />
					<value target='IconsOnRight' data='0' />
					<value target='OutputIcon::CommsType' data='006' />
					<value target='OutputIcon::LinkTo' data='0' />
					<value target='ConsoleHandle' data='537' />
					<value target='Upgraded' data='0' />
				</values>
				<events />
				<apis />
				<variables />
				<macros />
			</component>
		</component>
	</components>
	<scadaresourcelookup />
	<keymap />
	<panel2d shadows='0' lighting='2' brightness='0' >
		<background rgb='8882055' img='' style='0' />
		<camera xe='3.22728' ye='-1.70266' ze='226.702' xt='3.22728' yt='-1.70266' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<viewport dx='622' dy='343' zoom='331.987' fix_topleft='0' />
		<page x='1000' y='1000' show='0' rgb='0' />
		<winpos ID='7005' RectRecentFloat='1270,288,1920,738' RectRecentDocked='0,0,642,413' RecentFrameAlignment='16384' RecentRowIndex='0' IsFloating='1' MRUWidth='32767' PinState='0' IsMaximized='0' IsVisible='1' />
	</panel2d>
	<panel3d shadows='0' lighting='0' brightness='-51' perspective='1' >
		<background rgb='8398592' img='' style='0' />
		<table rgb='7360576' img='' style='0' size='0' />
		<camera xe='17.5492' ye='18.9907' ze='266.838' xt='17.5492' yt='18.9907' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<camerakey0 xe='0' ye='0' ze='300' xt='0' yt='0' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<camerakey1 xe='-3.67394e-14' ye='0' ze='-300' xt='0' yt='0' zt='0' xquat='0' yquat='1' zquat='0' wquat='6.12323e-17' />
		<camerakey2 xe='0' ye='-300' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.707107' yquat='0' zquat='0' wquat='0.707107' />
		<camerakey3 xe='-3.67394e-14' ye='300' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-4.32978e-17' yquat='0.707107' zquat='0.707107' wquat='4.32978e-17' />
		<camerakey4 xe='-300' ye='-6.66134e-14' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.5' yquat='0.5' zquat='0.5' wquat='0.5' />
		<camerakey5 xe='300' ye='-6.66134e-14' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.5' yquat='-0.5' zquat='-0.5' wquat='0.5' />
		<camerakey6 xe='-173.205' ye='-173.205' ze='173.205' xt='0' yt='0' zt='0' xquat='-0.424708' yquat='0.17592' zquat='0.339851' wquat='0.820473' />
		<winpos ID='7004' RectRecentFloat='1270,304,1920,754' RectRecentDocked='1274,183,1920,726' RecentFrameAlignment='16384' RecentRowIndex='0' IsFloating='1' MRUWidth='32767' PinState='0' IsMaximized='0' IsVisible='1' />
	</panel3d>
	<panels2d count='0' />
	<layout >
		<view type='0' name='Main' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ChangeFrameType' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_GetVarSize' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='GetResponseByte' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='GetResponseInt' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Initialise' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Initialise' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadAnalogInput' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SetHoldingRegister' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SendValueAsASCII' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Property' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadDigitalInput' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadCoil' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SetCoil' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadHoldingRegister' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SetHoldingRegisters' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SendAndCalcCRC16' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SetCoils' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='GetResponse' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Timer' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAeAAAAUwYAABoCAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
	</layout>
</document>
</root>
