<root>
<document scada='0' schema='103' license='10,BenR,C9TN1M' title='' description='' fcversion='655363' target='PIC.16F.16F1937' >
	<config data='!0,fe2!10,1eff%0,2%3,0%5,1%6,1%7,1%8,1%9,3%b,1%c,0%d,0%10,3%14,3%18,0%19,1%1a,1%1c,1%1d,0' clkspd='19660800' simspd='1' usewdt='0' constif='0' Use3V3='0' />
	<plugins >
		<dll_models enabled='1' />
	</plugins>
	<supplement use='0' head='' body='' />
	<debug />
	<traces />
	<ghost >
		<FK2 >
			<data name='FK2D0' port='4294967295' pin='4294967295' />
			<data name='FK2D1' port='4294967295' pin='4294967295' />
			<data name='FK2D2' port='4294967295' pin='4294967295' />
			<data name='FK2D3' port='4294967295' pin='4294967295' />
			<data name='FK2D4' port='4294967295' pin='4294967295' />
			<data name='FK2D5' port='4294967295' pin='4294967295' />
			<data name='FK2D6' port='4294967295' pin='4294967295' />
			<data name='FK2D7' port='4294967295' pin='4294967295' />
			<data name='FK2D8' port='4294967295' pin='4294967295' />
			<data name='FK2D9' port='4294967295' pin='4294967295' />
			<data name='FK2D10' port='4294967295' pin='4294967295' />
			<data name='FK2D11' port='4294967295' pin='4294967295' />
			<data name='FK2D12' port='4294967295' pin='4294967295' />
			<data name='FK2D13' port='4294967295' pin='4294967295' />
			<data name='FK2D14' port='4294967295' pin='4294967295' />
			<data name='FK2D15' port='4294967295' pin='4294967295' />
			<data name='FK2A0' port='4294967295' pin='4294967295' />
			<data name='FK2A1' port='4294967295' pin='4294967295' />
			<data name='FK2A2' port='4294967295' pin='4294967295' />
			<data name='FK2A3' port='4294967295' pin='4294967295' />
			<data name='FK2A4' port='4294967295' pin='4294967295' />
			<data name='FK2A5' port='4294967295' pin='4294967295' />
		</FK2>
		<ICD >
			<data name='AnalogPrescaleValue' value='19' />
			<data name='DigitalSampleRate' value='100000' />
			<data name='BreakpointCount' value='8' />
			<data name='CallStackDepthCount' value='8' />
			<data name='ClockPort' value='1' />
			<data name='ClockPin' value='6' />
			<data name='DataPort' value='1' />
			<data name='DataPin' value='7' />
			<data name='UseDefaultPins' value='1' />
			<data name='WrapEnabled' value='1' />
			<data name='CommsDelayOverridden' value='0' />
			<data name='CommsDelay' value='9' />
			<data name='CalculatedCommsDelay' value='9' />
			<data name='AnalogEB2PrescaleValue' value='2' />
			<data name='DigitalEB2SampleRate' value='100000' />
		</ICD>
		<pins >
			<digital A='0' B='0' C='0' D='0' E='0' F='0' G='0' H='0' I='0' J='0' K='0' L='0' M='0' N='0' O='0' P='0' Q='0' R='0' S='0' T='0' U='0' V='0' W='0' X='0' Y='0' Z='0' />
			<analog A='0' B='0' C='0' D='0' E='0' F='0' G='0' H='0' I='0' J='0' K='0' L='0' M='0' N='0' O='0' P='0' Q='0' R='0' S='0' T='0' U='0' V='0' W='0' X='0' Y='0' Z='0' />
		</pins>
	</ghost>
	<components >
		<settings autoimg='0' center='1' unitscale='1' fixedscale='0' fixedx='1' fixedy='1' fixedz='1' headcode='0' />
		<definition guid='ef2427ea-7767-43be-a0c5-6f705e3c2668' vstate='40' vmin='0' vmaj='1' srcleaf='PZEM-004T.fcfx' visiblename='Energy Monitor (PZEM-004T)' description='The PZEM-004T module is used for measuring AC voltage, current, active power, frequency, power
factor &amp; overcurrent.
Resetable active energ and the overpower level can be set and monitored.
' category='Electrical' category2='API Electrical' category3='' bIs2dOnly='1' bIs3dOnly='0' catenable='1' author='Matrix Ltd.' manuname='' manucode='' sysinfo='3150603' keywords='current|voltage.|power|factor|frequency' dynamic='1' scadaCompatible='1' embeddedCompatible='1' showmacros='1' iconpath='..\..\Icons\Components\PZEM-004T.png' />
		<component class_type='root' codename='PZEM004T' panelId='-1' x='0' y='0' z='0' xsz='1' ysz='1' zsz='1' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='0' poslock='0' comp2dType='0' >
			<resources />
			<properties >
				<property name='UART Properties' folder='property_1' hidden='0' >
					<property name='Channel' target='cal_uart::CHANNEL' typeid='16' hidden='0' locked='0' info='UART Channel selector
Software channels are bit banged using generic I/O pins but are not as reliable as hardware channels.
Hardware channels use the selected peripheral on-board the target microcontroller.' filter='000Software
001Channel 1
' />
					<property name='TX' target='cal_uart::TX' typeid='5' hidden='0' locked='1' info='Pin to be used for Transmit data' />
					<property name='TX Remap Pin' target='cal_uart::OutputPins' typeid='16' hidden='1' locked='0' info='Allows the hardware transmit pin to be configured from a list of available pins based on your target device,' filter='000$PORTA.0
001$PORTA.1
002$PORTA.2
003$PORTA.3
004$PORTA.4
005$PORTA.5
006$PORTA.7
007$PORTA.6' />
					<property name='TX Alt Pin' target='cal_uart::TXAlt' typeid='7' hidden='1' locked='0' info='Allows the TX pin to be allocated to an alternate I/O pin.' />
					<property name='RX' target='cal_uart::RX' typeid='5' hidden='0' locked='1' info='Pin to be used for Receive data' />
					<property name='RX Remap Pin' target='cal_uart::InputPins' typeid='16' hidden='1' locked='0' info='Allows the hardware receive pin to be configured from a list of available pins based on your target device,' filter='016$PORTC.0
017$PORTC.1
018$PORTC.2
019$PORTC.3
020$PORTC.4
021$PORTC.5
022$PORTC.6
023$PORTC.7' />
					<property name='RX Alt Pin' target='cal_uart::RXAlt' typeid='7' hidden='1' locked='0' info='Allows the RX pin to be allocated to an alternate I/O pin.' />
					<property name='Baud Options' target='cal_uart::BAUD_LIST' typeid='16' hidden='0' locked='0' info='Baud rate option selector' filter='000Custom
0011200
0022400
0034800
0049600
00519200
00631250
00738400
00857600
009115200' />
					<property name='Baud Rate' target='cal_uart::BAUD' typeid='14' hidden='0' locked='1' info='' />
					<property name='UART Index' target='UARTidx' typeid='21' hidden='1' locked='0' info='' />
					<property name='BaudByteDelay' target='BaudByteDelay' typeid='21' hidden='1' locked='0' info='' />
					<property name='Bus' target='BusType' typeid='16' hidden='0' locked='0' info='Specifies the bus mode being used,
RS232 allows you to connect a single master node to a single slave node.
RS485 allows you to connect a single master node to multiple slave nodes.' filter='000RS232
001RS485' />
					<property name='Data Direction Pin' target='DDRP' typeid='5' hidden='1' locked='0' info='Pin used to control the RS485 data direction.' />
					<property name='Read DDR State' target='ReadDDRState' typeid='16' hidden='1' locked='0' info='Specifies the pin state for read mode.' filter='000Low
001High' />
				</property>
				<property name='Modbus Properties' folder='property_2' hidden='0' >
					<property name='Receive Buffer Size' target='ReceiveBufferSize' typeid='21' hidden='0' locked='0' info='Maximum number of bytes the receive buffer can hold' />
					<property name='Slave ID Bytes' target='AddressBytes' typeid='21' hidden='0' locked='0' info='Number of bytes used when passing a slave ID, usually 1 but sometimes 2' />
					<property name='Silent Interval' target='SilentInterval' typeid='21' hidden='0' locked='0' info='Configures how much time to wait after each master modbus command before another command can be sent.
A silent interval of 60ms minimum is required in order to guarentee successful reception of the next transmission.
0=No Delay 
60 = 60mS - Default
Range : 0 - 65535' />
					<property name='UART Receive Timeout' target='RXTOUT' typeid='21' hidden='0' locked='0' info='Amount of time to wait before timing out when listening for a slave&apos;s response.
Range: 0 - 255.
0 = Don&apos;t Wait
1 - 254 = X ms
255 = Wait Forever' />
					<property name='Receive Timeout Count' target='TOUTCNT' typeid='21' hidden='0' locked='0' info='Number of timeouts in a row to wait for until we decide the slave is not responding or finished responding
to a message.
Range: 0 - 255
0 = First Timeout Only
1 = First Timeout + 1
2 = First Timeout + 2' />
				</property>
				<property name='Simulation Properties' folder='property_3' hidden='0' >
					<property name='Label' target='label' typeid='10' hidden='0' locked='0' info='A text label to appear on the Modbus panel object.' />
					<property name='Scope Traces' target='cal_uart::ScopeTraces' typeid='7' hidden='0' locked='0' info='Selects if the scope traces are automatically added to the data recorder window or not.
    Simulation - draws an approximation of the UART data onto the scope trace.
    ICT - sets up the scope trace for incoming data and adds UART packet decoding at the correct BAUD.' />
					<property name='Console Data' target='cal_uart::ConsoleData' typeid='7' hidden='0' locked='0' info='Selects if the console data is automatically generated or not' />
					<property name='Console Columns' target='cal_uart::ConsoleColumns' typeid='21' hidden='0' locked='0' info='Number of characters that can be displayed on a single line of the console.' />
					<property name='Data Source' target='cal_uart::DataSource' typeid='16' hidden='0' locked='0' info='Simulation data source used to allow the component to connect to various remote devices
    Nothing - Simulation data is ignored
    COM port - Routes the communication data to and from a physical or virtual COM port 
    API - Routes the communication data via a data API component on the Panel.' filter='000Nothing
001COM Port
002Data API' />
					<property name='COM Port' target='cal_uart::com_port' typeid='16' hidden='1' locked='0' info='Lists all the current available COM port hardware on your PC.' filter='001COM1 Communications Port
013COM13 USB Serial Port' />
					<property name='API' target='cal_uart::Injector' typeid='16' hidden='1' locked='0' info='Selects which API component to route the communication data via.
Add API components to the panel before they will be available in this list.
API components are available from the Comms component category.' filter='000' />
					<property name='API Use DDR' target='cal_uart::APIUseDDR' typeid='7' hidden='1' locked='0' info='Allows the use of DDR pin for use with a RS485 transciever' />
					<property name='API DDR Pin' target='cal_uart::APIDDRPin' typeid='21' hidden='1' locked='0' info='Digital I/O Pin Number' />
					<property name='API DDR RX State' target='cal_uart::APIDDRRXState' typeid='16' hidden='1' locked='0' info='' filter='000Low
001High' />
					<property name='API Use Flow Control' target='cal_uart::APIUseFC' typeid='7' hidden='1' locked='0' info='Allows the use of Flow Control via API I/O Pins' />
					<property name='API CTS Pin' target='cal_uart::APICTSPin' typeid='21' hidden='1' locked='0' info='Digital Input Pin used as CTS (Clear To Send) Flow Control Pin' />
					<property name='API RTS Pin' target='cal_uart::APIRTSPin' typeid='21' hidden='1' locked='0' info='Digital Output Pin used as RTS (Request To Send) Flow Control Pin' />
				</property>
			</properties>
			<values >
				<value target='cal_uart::CHANNEL' data='001' />
				<value target='cal_uart::TX' data='$PORTC.6' />
				<value target='cal_uart::OutputPins' data='000' />
				<value target='cal_uart::TXAlt' data='0' />
				<value target='cal_uart::RX' data='$PORTC.7' />
				<value target='cal_uart::InputPins' data='085' />
				<value target='cal_uart::RXAlt' data='0' />
				<value target='cal_uart::BAUD_LIST' data='004' />
				<value target='cal_uart::BAUD' data='9600' />
				<value target='UARTidx' data='001' />
				<value target='BaudByteDelay' data='1040' />
				<value target='BusType' data='000' />
				<value target='DDRP' data='$PORTA.0' />
				<value target='ReadDDRState' data='000' />
				<value target='ReceiveBufferSize' data='20' />
				<value target='AddressBytes' data='1' />
				<value target='SilentInterval' data='60' />
				<value target='RXTOUT' data='220' />
				<value target='TOUTCNT' data='2' />
				<value target='label' data='Modbus' />
				<value target='cal_uart::ScopeTraces' data='1' />
				<value target='cal_uart::ConsoleData' data='1' />
				<value target='cal_uart::ConsoleColumns' data='64' />
				<value target='cal_uart::DataSource' data='000' />
				<value target='cal_uart::com_port' data='000' />
				<value target='cal_uart::Injector' data='000' />
				<value target='cal_uart::APIUseDDR' data='' />
				<value target='cal_uart::APIDDRPin' data='' />
				<value target='cal_uart::APIDDRRXState' data='' />
				<value target='cal_uart::APIUseFC' data='' />
				<value target='cal_uart::APICTSPin' data='' />
				<value target='cal_uart::APIRTSPin' data='' />
			</values>
			<events >
				<event class='Components' event='Property' target='Ev_Property' />
				<event class='Components' event='Renamed' target='Ev_Renamed' />
				<event class='Components' event='Initialise' target='Ev_Initialise' />
				<event class='Compile' event='GetVarSize' target='Ev_GetVarSize' />
			</events>
			<apis >
				<api name='ReadFrequency' alt='ReadFrequency' type='1' proto='1' />
				<api name='ReadAlarmStatus' alt='ReadAlarmStatus' type='1' proto='1' />
				<api name='ResetEnergy' alt='ResetEnergy' type='1' proto='1' />
				<api name='ReadVoltage' alt='ReadVoltage' type='1' proto='1' />
				<api name='SetPowerThresholdLevel' alt='SetPowerThresholdLevel' type='1' proto='1' />
				<api name='ReadPower' alt='ReadPower' type='1' proto='1' />
				<api name='ReadEnergy' alt='ReadEnergy' type='1' proto='1' />
				<api name='ReadCurrent' alt='ReadCurrent' type='1' proto='1' />
				<api name='ReadPowerFactor' alt='ReadPowerFactor' type='1' proto='1' />
				<api name='ReadPowerAlarmThreshold' alt='ReadPowerAlarmThreshold' type='1' proto='1' />
				<api name='Initialise' alt='Initialise' type='1' proto='1' />
			</apis>
			<variables >
				<variable public='0' >
					<def class_type='variable' name='FrameTypeVar' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='ConsoleHandle' type='h32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='Sum' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
				</variable>
				<variable public='0' >
					<def class_type='variable' name='ResponseBuffer' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
						<array size='50' />
					</def>
				</variable>
			</variables>
			<macros >
				<macro >
					<flowline name='ReadFrequency' description='Reads the frequency of the mains' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='LowUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='User Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='7' />
							<argument exp='1' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.LowUInt' />
									<argument exp='4' />
								</command>
								<command class_type='calculation' title='Convert to frequency' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = FLOAT .LowUInt * 0.1' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='999999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 999999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadFrequency &quot; + String .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadPowerAlarmThresh' description='Read the alarm threshold value' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegAddress' type='u16' description='Input Address: 0=10001, 1=10002, 2=10003, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegCount' type='u16' description='Number of consecutive inputs to read, starting from RegAddress' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Address:&quot; + STRING (.RegAddress + 30001)' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; RegCount:&quot; + STRING .RegCount' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='call' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Read Input Register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x03' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$ (.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Initialise' description='Initialisation routine for the component once the component is linked to its parent' statediag='0' >
						<return name='Return' type='u32' description='Non-zero to prevent initialisation' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='TempStr' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='comment' title='' comment='Setup Modbus Console Tab' textarea='12,0,12,0' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.AddText' >
							<return exp='ConsoleHandle' />
							<argument exp='&quot;Modbus Data&quot;' />
							<argument exp='0' />
						</command>
						<command class_type='call' title='Call Macro' disable='1' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Ev_Property' />
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadAlarmStatus' description='65535 = Overpower alarm triggered.
0 = Overpower alarm not  triggered.' statediag='0' >
						<return name='Return' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='UInt' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='User Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.UInt' />
							<argument exp='1' />
							<argument exp='9' />
							<argument exp='1' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.UInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.UInt' />
									<argument exp='4' />
								</command>
								<command class_type='calculation' title='Convert to alarm status' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = .UInt' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='99999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 99999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadAlarmStatus value &quot; + STRING .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='GetResponse' description='Collects as much incoming data as possible and stored into the response buffer. The number of bytes received will be stored into location 0 of the response buffer.
Return value indicates validity of incoming CRC. 0 = OK, 1 = CRC fail, 255 = No Data' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='in' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Index' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<local name='Bit' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRCTest' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='TCnt' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Index2' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Str' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='2' />
						</local>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;\n  &quot;' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;Reply -&gt; &quot;' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='BusType = 1' swap='0' >
							<flowline >
								<command class_type='delay' title='Delay to ensure last byte is sent before we switch the R/W state' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='BaudByteDelay' type='0' />
								<command class_type='delay' title='Delay to ensure last byte is sent before we switch the R/W state' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='BaudByteDelay' type='0' />
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='UARTIdx = 1' swap='0' >
									<flowline >
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC16
while (U1STAbits.UTXBF != 0);
while (U1STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC32
while (U1STAbits.UTXBF != 0);
while (U1STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_ESP
uart_wait_tx_done(UART_NUM_0, 1000);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
									</flowline>
									<flowline />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='UARTIdx = 2' swap='0' >
									<flowline >
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC16
while (U2STAbits.UTXBF != 0);
while (U2STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC32
while (U2STAbits.UTXBF != 0);
while (U2STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_ESP
uart_wait_tx_done(UART_NUM_1, 1000);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
									</flowline>
									<flowline />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='UARTIdx = 3' swap='0' >
									<flowline >
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC16
while (U3STAbits.UTXBF != 0);
while (U3STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC32
while (U3STAbits.UTXBF != 0);
while (U3STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_ESP
uart_wait_tx_done(UART_NUM_2, 1000);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
									</flowline>
									<flowline />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='UARTIdx = 4' swap='0' >
									<flowline >
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC16
while (U4STAbits.UTXBF != 0);
while (U4STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC32
while (U4STAbits.UTXBF != 0);
while (U4STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
									</flowline>
									<flowline />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='UARTIdx = 5' swap='0' >
									<flowline >
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC32
while (U5STAbits.UTXBF != 0);
while (U5STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
									</flowline>
									<flowline />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='UARTIdx = 6' swap='0' >
									<flowline >
										<command class_type='native' title='C Code' ccode='#ifdef MX_CAL_PIC32
while (U6STAbits.UTXBF != 0);
while (U6STAbits.TRMT != 1);
#endif' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' language='C' />
									</flowline>
									<flowline />
								</command>
								<command class_type='delay' title='Delay' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='10' type='0' />
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='ReadDDRState = 1' swap='0' >
									<flowline >
										<command class_type='calculation' title='Read DDR Mode' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='DDRP = 1' />
										</command>
									</flowline>
									<flowline >
										<command class_type='calculation' title='Read DDR Mode' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='DDRP = 0' />
										</command>
									</flowline>
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='calculation' title='No Data Received Yet' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='ResponseBuffer[0] = 0' />
						</command>
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.TCnt = 0' />
						</command>
						<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index &lt; ReceiveBufferSize' start='0' >
							<flowline >
								<command class_type='call' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Receive' >
									<return exp='.in' />
									<argument exp='RXTOUT' />
								</command>
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.in &lt; 256' swap='0' >
									<flowline >
										<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.TCnt = 0' />
										</command>
										<command class_type='calculation' title='Increment data received counter' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[0] = ResponseBuffer[0] + 1' />
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Index = .Index + 1' />
										</command>
										<command class_type='calculation' title='Add received data to buffer' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[.Index] = .in' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar' swap='0' >
											<flowline >
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.in &gt; 13' swap='0' >
													<flowline >
														<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.Str[0] = .in' />
															<exp exp='.Str[1] = 0' />
														</command>
														<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
															<argument exp='ConsoleHandle' />
															<argument exp='.str' />
														</command>
													</flowline>
													<flowline />
												</command>
											</flowline>
											<flowline >
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='STRING .in + &quot;,&quot;' />
												</command>
											</flowline>
										</command>
									</flowline>
									<flowline >
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.TCnt = TOUTCNT' swap='0' >
											<flowline >
												<command class_type='goto' title='Goto Connection Point' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' labelid='0' labelname='' />
											</flowline>
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.TCnt = .TCnt + 1' />
												</command>
											</flowline>
										</command>
									</flowline>
								</command>
							</flowline>
						</command>
						<command class_type='label' title='Connection Point' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' labelid='0' labelname='A' />
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar' swap='0' >
							<flowline >
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[0] &gt;= 4' swap='0' >
									<flowline >
										<command class_type='calculation' title='Remove &apos;:&apos; and Line End from incoming data size' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[0] = ResponseBuffer[0] - 2' />
											<exp exp='ResponseBuffer[0] = (ResponseBuffer[0] / 2) + 1' />
											<exp exp='' />
										</command>
										<command class_type='calculation' title='Skip over &apos;:&apos;' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Index = 2' />
											<exp exp='.Index2 = 1' />
											<exp exp='.Bit = 0' />
										</command>
										<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index2 &lt; ResponseBuffer[0]' >
											<flowline >
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[.Index] &gt; &apos;9&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index] - &apos;A&apos;' />
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] + 10' />
														</command>
													</flowline>
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index] - &apos;0&apos;' />
														</command>
													</flowline>
												</command>
												<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] &lt;&lt; 4' />
												</command>
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Index = .Index + 1' />
												</command>
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[.Index] &gt; &apos;9&apos;' swap='0' >
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] | (ResponseBuffer[.Index] - &apos;A&apos;)' />
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] + 10' />
														</command>
													</flowline>
													<flowline >
														<command class_type='calculation' title='' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='ResponseBuffer[.Index2] = ResponseBuffer[.Index2] | (ResponseBuffer[.Index] - &apos;0&apos;)' />
														</command>
													</flowline>
												</command>
												<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.Index2 &lt; (ResponseBuffer[0] - 1)' swap='0' >
													<flowline >
														<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.Bit = .Bit + ResponseBuffer[.Index2]' />
														</command>
													</flowline>
													<flowline />
												</command>
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Index = .Index + 1' />
													<exp exp='.Index2 = .Index2 + 1' />
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Bit = (~ .Bit) + 1' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.Bit = ResponseBuffer[.Index2 - 1]' swap='0' >
											<flowline >
												<command class_type='calculation' title='CRC Correct' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 0' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; LRC:OK&quot;' />
												</command>
											</flowline>
											<flowline >
												<command class_type='calculation' title='CRC Fail' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 1' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; LRC:Fail &quot; + NumberToHex$(.Bit) + &quot;:&quot; + NumberToHex$(ResponseBuffer[.Index])' />
												</command>
											</flowline>
										</command>
									</flowline>
									<flowline >
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Return = 255' />
										</command>
										<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
											<argument exp='ConsoleHandle' />
											<argument exp='&quot;Timeout&quot;' />
										</command>
									</flowline>
								</command>
							</flowline>
							<flowline >
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='ResponseBuffer[0] &gt;= 2' swap='0' >
									<flowline >
										<command class_type='calculation' title='Remove CRC from incoming data size' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='ResponseBuffer[0] = ResponseBuffer[0] - 2' />
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Index = 0' />
										</command>
										<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' type='0' exp='.Index &lt; ResponseBuffer[0]' >
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Index = .Index + 1' />
												</command>
												<command class_type='calculation' title='XOR DataByte with CRC' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.CRC = .CRC ^ ResponseBuffer[.Index]' />
												</command>
												<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' type='2' exp='8' >
													<flowline >
														<command class_type='calculation' title='Read LS bit' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.Bit = .CRC &amp; 0x01' />
														</command>
														<command class_type='calculation' title='Shift CRC by one place' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
															<exp exp='.CRC = .CRC &gt;&gt; 1' />
														</command>
														<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.Bit' swap='0' >
															<flowline >
																<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
																	<exp exp='.CRC = .CRC ^ 0xA001' />
																</command>
															</flowline>
															<flowline />
														</command>
													</flowline>
												</command>
											</flowline>
										</command>
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.CRCTest = (ResponseBuffer[.Index] &lt;&lt; 8) + ResponseBuffer[.Index + 1]' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='(.CRCTest &amp; 0xFF) = (.CRC &amp; 0xFF)' swap='0' >
											<flowline >
												<command class_type='calculation' title='CRC Correct' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 0' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; CRC:OK&quot;' />
												</command>
											</flowline>
											<flowline >
												<command class_type='calculation' title='CRC Fail' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.Return = 1' />
												</command>
												<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
													<argument exp='ConsoleHandle' />
													<argument exp='&quot; CRC:Fail &quot; + NumberToHex$(.CRCTest) + &quot;:&quot; + NumberToHex$(.CRC)' />
												</command>
											</flowline>
										</command>
									</flowline>
									<flowline >
										<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Return = 255' />
										</command>
										<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
											<argument exp='ConsoleHandle' />
											<argument exp='&quot;Timeout&quot;' />
										</command>
									</flowline>
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;\n&quot;' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='BusType = 1' swap='0' >
							<flowline >
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='ReadDDRState = 1' swap='0' >
									<flowline >
										<command class_type='calculation' title='Write DDR Mode' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='DDRP = 0' />
										</command>
									</flowline>
									<flowline >
										<command class_type='calculation' title='Write DDR Mode' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='DDRP = 1' />
										</command>
									</flowline>
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='SilentInterval &gt; 0' swap='0' >
							<flowline >
								<command class_type='delay' title='Delay' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' exp='SilentInterval' type='1' />
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ResetEnergy' description='Reset the energy value' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ResetEnergy&quot;' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='1 &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='1' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Reset energy register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x42' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
							<argument exp='.CRC &amp; 0xFF' />
						</command>
						<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
							<argument exp='.CRC &gt;&gt; 8' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='GetResponseByte' description='Reads a byte from the last received response. The Index parametes specifies which byte to read back.
' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='Index' type='u8' description='0=NumBytes, 1=SlaveAddress, 2=FunctionCode/ExceptionCode, 3=DataBytes, 4=data0, 5=data1, ..' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Return = ResponseBuffer[.Index]' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadVoltage' description='Read voltage.
Measuring range:80260V
Resolution: 0.1V
Measurement accuracy: 0.5%' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='LowUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='Read voltage register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='0' />
							<argument exp='1' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.LowUInt' />
									<argument exp='4' />
								</command>
								<command class_type='calculation' title='Convert to voltage' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = FLOAT .LowUInt * 0.1' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='999999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 999999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadVoltage &quot; + String .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SetPowerThresholdLevel' description='Sets the power alarm threshold in watts' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='PowerThresholdValue' type='u16' description='Reg addreess high of alarm threshold' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<local name='PowerThreshHigh' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='PowerThreshLow' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot; Power threshold value:&quot; + STRING (.PowerThresholdValue)' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = 0' />
								</command>
								<command class_type='call' title='Send ASCII Start' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;:&apos;' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x01' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Read Input Register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x06' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register high' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Register low' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='1' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.PowerThresholdValue &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.PowerThresholdValue' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$ (.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Property' description='Sent when a property has been changed by the User' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Temp_Str' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<local name='Bval' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='GetConsoleHandle' >
							<return exp='ConsoleHandle' />
						</command>
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='SetConsoleHandle' >
							<argument exp='ConsoleHandle' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &lt; 1' swap='0' >
							<flowline >
								<command class_type='sim' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
									<argument exp='this' />
									<argument exp='&quot;AddressBytes&quot;' />
									<argument exp='1' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 2' swap='0' >
							<flowline >
								<command class_type='sim' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
									<argument exp='this' />
									<argument exp='&quot;AddressBytes&quot;' />
									<argument exp='2' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='BusType = 1' swap='0' >
							<flowline >
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetVisible' >
									<argument exp='this' />
									<argument exp='&quot;DDRP&quot;' />
									<argument exp='1' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetVisible' >
									<argument exp='this' />
									<argument exp='&quot;ReadDDRState&quot;' />
									<argument exp='1' />
								</command>
							</flowline>
							<flowline >
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetVisible' >
									<argument exp='this' />
									<argument exp='&quot;DDRP&quot;' />
									<argument exp='0' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetVisible' >
									<argument exp='this' />
									<argument exp='&quot;ReadDDRState&quot;' />
									<argument exp='0' />
								</command>
							</flowline>
						</command>
						<command class_type='comment' title='' comment='Work out delay for a byte at current BAUD' textarea='12,0,12,0' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.GetValue' >
							<return exp='.Temp_Str' />
							<argument exp='cal_uart' />
							<argument exp='&quot;BAUD&quot;' />
						</command>
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Bval = StringToInt$ (.Temp_Str)' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
							<argument exp='this' />
							<argument exp='&quot;BaudByteDelay&quot;' />
							<argument exp='(1000000 / .BVal) * 10' />
						</command>
						<command class_type='comment' title='' comment='Record current UART channel' textarea='12,0,12,0' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.GetValue' >
							<return exp='.Temp_Str' />
							<argument exp='cal_uart' />
							<argument exp='&quot;CHANNEL&quot;' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
							<argument exp='this' />
							<argument exp='&quot;UARTidx&quot;' />
							<argument exp='.Temp_Str' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_Renamed' description='' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Name' type='T8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</local>
						<command class_type='sim' title='' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Tree.GetName' >
							<return exp='.Name' />
							<argument exp='this' />
						</command>
						<command class_type='sim' title='' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Component.Property.SetValue' >
							<argument exp='LibraryComponent1' />
							<argument exp='&quot;Name&quot;' />
							<argument exp='.Name' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadPower' description='Read active power.
Starting measure power: 0.4W
Resolution: 0.1W' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='LowUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='Long' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='HighUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='Read power register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='3' />
							<argument exp='2' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.LowUInt' />
									<argument exp='4' />
								</command>
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.HighUInt' />
									<argument exp='6' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='SetInt' >
									<argument exp='0' />
									<argument exp='.LowUInt' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='SetInt' >
									<argument exp='1' />
									<argument exp='.HighUInt' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='GetLong' >
									<return exp='.Long' />
								</command>
								<command class_type='calculation' title='Convert to power' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = FLOAT .Long * 0.1' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='999999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 999999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadPower &quot; + String .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SendValueAsASCII' description='' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<param name='Value' type='u8' description='Value to break up into ASCII characters' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Character' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Character = (.Value &amp; 0xF0) &gt;&gt; 4' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.Character &gt; 9' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character - 10' />
									<exp exp='.Character = .Character + &apos;A&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character + &apos;0&apos;' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Send MS bits' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
							<argument exp='.Character' />
						</command>
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Character = .Value &amp; 0x0F' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.Character &gt; 9' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character - 10' />
									<exp exp='.Character = .Character + &apos;A&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Character = .Character + &apos;0&apos;' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Send LS bits' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
							<argument exp='.Character' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Ev_GetVarSize' description='Sent to a component to amend the size of the expected array' statediag='0' >
						<return name='Return' type='u32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='VarName' type='T8' description='The original Flowcode variable' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='20' />
						</param>
						<param name='Elements' type='u32*' description='The number of elements in the array' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='comp' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.comp = Compare$ (.VarName,&quot;ResponseBuffer&quot;,1)' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.comp = 0' swap='0' >
							<flowline >
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Elements = ReceiveBufferSize' />
								</command>
							</flowline>
							<flowline />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='GetResponseInt' description='Reads a 16-bit value from the last received response. 
The Index parametes specifies the byte index of the value to read back.
' statediag='0' >
						<return name='Return' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='Index' type='u8' description='4=data0, 6=data1, 8=data2, ..' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
							<exp exp='.Return = ResponseBuffer[.Index] &lt;&lt; 8' />
							<exp exp='.Return = .Return | ResponseBuffer[.Index + 1]' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadAnalogInput' description='This command requests the analogue input register values starting from the start RegAddress and going through to RegAddress plus RegCount.
Returns 0 for success, 1 for CRC fail and 255 for no reply.' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='SlaveID' type='u16' description='The ID of the MODBUS slave' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegAddress' type='u16' description='Input Address: 0=10001, 1=10002, 2=10003, ...' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='RegCount' type='u16' description='Number of consecutive inputs to read, starting from RegAddress' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='CRC' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='65535' setinit='0xFFFF' />
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;Register address:&quot; + STRING .RegAddress' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='AddressBytes &gt; 1' swap='0' >
							<flowline >
								<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
									<return exp='.CRC' />
									<argument exp='.SlaveID &gt;&gt; 8' />
									<argument exp='.CRC' />
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Send Slave ID' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.SlaveID' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Read Input Register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='0x04' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Data address of first register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegAddress' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount &gt;&gt; 8' />
							<argument exp='.CRC' />
						</command>
						<command class_type='call' title='Number of registers to read' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendAndCalcCRC16' >
							<return exp='.CRC' />
							<argument exp='.RegCount' />
							<argument exp='.CRC' />
						</command>
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='calculation' title='Convert Sum to Two&apos;s compliment' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = (~Sum) + 1' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='Sum' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; LRC:&quot; + STRING Sum' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;\r&apos;' />
								</command>
								<command class_type='call' title='Send LRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='&apos;\n&apos;' />
								</command>
							</flowline>
							<flowline >
								<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='.CRC &amp; 0xFF' />
								</command>
								<command class_type='call' title='Send CRC' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='.CRC &gt;&gt; 8' />
								</command>
								<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
									<argument exp='ConsoleHandle' />
									<argument exp='&quot; CRC:&quot; + NumberToHex$(.CRC)' />
								</command>
							</flowline>
						</command>
						<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponse' >
							<return exp='.Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='SendAndCalcCRC16' description='Transmits a databyte to the bus and calculates the current value of the CRC, returns the CRC updated with the new data byte.' statediag='0' >
						<return name='Return' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='DataByte' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<param name='CRC16' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='Bit' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashTx' />
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='FrameTypeVar = 1' swap='0' >
							<flowline >
								<command class_type='call' title='Call Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SendValueAsASCII' >
									<argument exp='.DataByte' />
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='Sum = Sum + .DataByte' />
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 0' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='XOR DataByte with CRC' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.CRC16 = .CRC16 XOR .DataByte' />
								</command>
								<command class_type='call' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Send' >
									<argument exp='.DataByte' />
								</command>
								<command class_type='loop' title='Loop' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' type='2' exp='8' >
									<flowline >
										<command class_type='calculation' title='Read LS bit' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.Bit = .CRC16 &amp; 0x01' />
										</command>
										<command class_type='calculation' title='Shift CRC by one place' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='.CRC16 = .CRC16 &gt;&gt; 1' />
										</command>
										<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.Bit' swap='0' >
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.CRC16 = .CRC16 &amp; 0x7FFF' />
													<exp exp='.CRC16 = .CRC16 XOR 0xA001' />
												</command>
											</flowline>
											<flowline >
												<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
													<exp exp='.CRC16 = .CRC16 &amp; 0x7FFF' />
												</command>
											</flowline>
										</command>
									</flowline>
								</command>
								<command class_type='calculation' title='Calculation' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = .CRC16' />
								</command>
							</flowline>
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadEnergy' description='Read active energy value.
Resolution: 1Wh
Measurement accuracy: 0.5%' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='LowUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='Long' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='HighUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='Read energy register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='5' />
							<argument exp='2' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.LowUInt' />
									<argument exp='4' />
								</command>
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.HighUInt' />
									<argument exp='6' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='SetInt' >
									<argument exp='0' />
									<argument exp='.LowUInt' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='SetInt' >
									<argument exp='1' />
									<argument exp='.HighUInt' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='GetLong' >
									<return exp='.Long' />
								</command>
								<command class_type='calculation' title='Convert to energy' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = FLOAT .Long' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='999999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 999999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadEnergy &quot; + String .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadPowerFactor' description='Read power factor
Resolution: 0.01
Measurement accuracy: 1%' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='LowUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='Read current register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='8' />
							<argument exp='1' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.LowUInt' />
									<argument exp='4' />
								</command>
								<command class_type='calculation' title='Convert to power factor' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = FLOAT .LowUInt * 0.01' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='999999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 999999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadPowerFactor &quot; + String .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadCurrent' description='Read what the current draw is. Resolution: 0.001A
Measurement accuracy: 0.5%' statediag='0' >
						<return name='Return' type='f32' description='' isconst='0' isHidden='0' isinit='0' usrinit='0.0' setinit='' />
						<local name='LowUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='Long' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<local name='HighUInt' type='u32' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='Read current register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='1' />
							<argument exp='2' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.LowUInt' />
									<argument exp='4' />
								</command>
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.HighUInt' />
									<argument exp='6' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='SetInt' >
									<argument exp='0' />
									<argument exp='.LowUInt' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='SetInt' >
									<argument exp='1' />
									<argument exp='.HighUInt' />
								</command>
								<command class_type='call' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='TypeConversions1' macro='GetLong' >
									<return exp='.Long' />
								</command>
								<command class_type='calculation' title='Convert to current' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = FLOAT .Long * 0.001' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='999999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 999999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadCurrent &quot; + String .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Main' description='' statediag='0' >
						<return name='Return' type='v0' description='' isconst='0' isHidden='0' isinit='0' usrinit='' setinit='' />
						<local name='test' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='&quot;&quot;' setinit='' >
							<array size='2' />
						</local>
						<local name='test2' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' >
							<array size='2' />
						</local>
						<command class_type='call' title='User Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='SetPowerThresholdLevel' >
							<argument exp='1234' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='ReadPowerAlarmThreshold' description='Reads the power alarm threshold in watts' statediag='0' >
						<return name='Return' type='u16' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='LowUInt' type='u16' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='User Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadPowerAlarmThresh' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='0x0001' />
							<argument exp='1' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='call' title='Get 16-bit register value' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='GetResponseInt' >
									<return exp='.LowUInt' />
									<argument exp='4' />
								</command>
								<command class_type='calculation' title='Convert to frequency' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = .LowUInt' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='999999 value = data invalid' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 9999' />
								</command>
							</flowline>
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.SetOutputRGB' >
							<argument exp='ConsoleHandle' />
							<argument exp='0xFF0000' />
						</command>
						<command class_type='sim' title='Simulation' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='Console.WriteText' >
							<argument exp='ConsoleHandle' />
							<argument exp='&quot;ReadPowerAlarmThreshold &quot; + String .Return' />
						</command>
					</flowline>
				</macro>
				<macro >
					<flowline name='Initialise' description='Starts up the UART to allow communications.
Also, checks if PZEM-004T is detected.
Returns 0 if detected or 255 if not detected.

' statediag='0' >
						<return name='Return' type='u8' description='' isconst='0' isHidden='0' isinit='0' usrinit='0' setinit='' />
						<local name='LowUInt' type='u8' description='' isconst='0' isHidden='0' isinit='1' usrinit='0' setinit='0' />
						<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='BusType = 1' swap='0' >
							<flowline >
								<command class_type='decision' title='Decision' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='ReadDDRState = 1' swap='0' >
									<flowline >
										<command class_type='calculation' title='Write DDR Mode' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='DDRP = 0' />
										</command>
									</flowline>
									<flowline >
										<command class_type='calculation' title='Write DDR Mode' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
											<exp exp='DDRP = 1' />
										</command>
									</flowline>
								</command>
							</flowline>
							<flowline />
						</command>
						<command class_type='call' title='Call Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='cal_uart' macro='Init' />
						<command class_type='sim' title='Component Macro' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' component='LibraryComponent1' macro='FlashRx' />
						<command class_type='call' title='Read voltage register' cmdcolor='4487093' cmdcolor_sec='11066367' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' macro='ReadAnalogInput' >
							<return exp='.LowUInt' />
							<argument exp='1' />
							<argument exp='0' />
							<argument exp='1' />
						</command>
						<command class_type='decision' title='Command OK' cmdcolor='4767473' cmdcolor_sec='11337727' cmdcolor_txt='0' cmdgradient='4' cmdopacity='0.64' exp='.LowUInt = 0' swap='0' >
							<flowline >
								<command class_type='calculation' title='Comms OK' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 0' />
								</command>
							</flowline>
							<flowline >
								<command class_type='calculation' title='255 value =Comms not OK' cmdcolor='4206456' cmdcolor_sec='10785756' cmdcolor_txt='16777215' cmdgradient='4' cmdopacity='0.64' >
									<exp exp='.Return = 255' />
								</command>
							</flowline>
						</command>
					</flowline>
				</macro>
			</macros>
			<component class_type='ref' guid='91b64b1d-b8b2-40f1-b073-e953a91fa234' vmin='2' vmaj='2' codename='cal_uart' panelId='-1' x='0.465264' y='-0.310176' z='17.6425' xsz='0.0005' ysz='0.0005' zsz='0.0005' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='1' poslock='0' comp2dType='0' >
				<resources />
				<properties />
				<values >
					<value target='UseUART' data='1' />
					<value target='CHANNEL' data='001' />
					<value target='UseTX' data='1' />
					<value target='TX' data='$PORTC.6' />
					<value target='OutputPins' data='000' />
					<value target='TXAlt' data='0' />
					<value target='UseRX' data='1' />
					<value target='RX' data='$PORTC.7' />
					<value target='InputPins' data='085' />
					<value target='RXAlt' data='0' />
					<value target='FLOWEN' data='0' />
					<value target='RTS' data='$PORTC.4' />
					<value target='CTS' data='$PORTC.5' />
					<value target='BAUD_LIST' data='004' />
					<value target='BAUD' data='9600' />
					<value target='DBITS' data='008' />
					<value target='RETURN' data='001' />
					<value target='ECHO' data='000' />
					<value target='INT' data='000' />
					<value target='ScopeTraces' data='1' />
					<value target='ConsoleData' data='1' />
					<value target='ConsoleFormat' data='000' />
					<value target='ConsoleColumns' data='64' />
					<value target='DataSource' data='000' />
					<value target='com_port' data='000' />
					<value target='Injector' data='000' />
					<value target='InjectorHandle' data='0' />
					<value target='InjectorChannel' data='0' />
					<value target='APIUseDDR' data='0' />
					<value target='APIDDRPin' data='0' />
					<value target='APIUseFC' data='' />
					<value target='APICTSPin' data='0' />
					<value target='APIRTSPin' data='' />
					<value target='APIDDRRXState' data='000' />
					<value target='NoIO' data='' />
					<value target='REF' data='0' />
					<value target='TX_PORT' data='$PORTC.6' />
					<value target='TX_TRIS' data='$PORTC.6' />
					<value target='TX_PIN' data='6' />
					<value target='RX_PORT' data='$PORTC.7' />
					<value target='RX_TRIS' data='$PORTC.7' />
					<value target='RX_PIN' data='7' />
					<value target='CTS_PORT' data='$PORTC.5' />
					<value target='CTS_PIN' data='5' />
					<value target='CTS_TRIS' data='$PORTC.5' />
					<value target='RTS_PORT' data='$PORTC.4' />
					<value target='RTS_PIN' data='4' />
					<value target='RTS_TRIS' data='$PORTC.4' />
					<value target='REMAPPABLE' data='' />
					<value target='OutputReg' data='000' />
					<value target='InputReg' data='000' />
					<value target='TXRPNUM' data='16' />
					<value target='TXBank' data='b' />
					<value target='RXRPREG' data='RXPPS' />
					<value target='RXBank' data='b' />
					<value target='UARTName' data='USART1' />
					<value target='UARTClock' data='' />
					<value target='UartNumber' data='' />
					<value target='TXBank2' data='c' />
					<value target='RXBank2' data='c' />
					<value target='TX_ALT' data='' />
					<value target='RX_ALT' data='' />
					<value target='BitDelay' data='104' />
					<value target='ParentName' data='PZEM004T' />
					<value target='CompName' data='' />
				</values>
				<events />
				<apis />
				<variables />
				<macros />
			</component>
			<component class_type='ref' guid='58be670e-18fb-477e-ab09-61fde14b23ec' vmin='0' vmaj='1' codename='LibraryComponent1' panelId='-1' x='10' y='0' z='0' xsz='100' ysz='100' zsz='100' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='1' scadavisible='1' interactive='1' solid='1' layer='1' poslock='1' comp2dType='0' >
				<resources />
				<properties />
				<values >
					<value target='Text::sText' data='Energy Monitor
PZEM-004T' />
					<value target='Name' data='' />
					<value target='Peripheral::sText' data='(UART CH1)' />
					<value target='Text::nVerticalAlignment' data='002' />
					<value target='ShowComms' data='1' />
					<value target='InputIcon::CommsType' data='255' />
					<value target='InputIcon::LinkTo' data='0' />
					<value target='IconsOnRight' data='0' />
					<value target='OutputIcon::CommsType' data='255' />
					<value target='OutputIcon::LinkTo' data='0' />
					<value target='ConsoleHandle' data='847' />
					<value target='Upgraded' data='0' />
				</values>
				<events />
				<apis />
				<variables />
				<macros />
			</component>
			<component class_type='ref' guid='6508c7be-063a-4f9f-bae5-4a41cf977a86' vmin='0' vmaj='1' codename='TypeConversions1' panelId='-1' x='0' y='0' z='0' xsz='1' ysz='1' zsz='25' xang='0' yang='0' zang='0' xquat='0' yquat='0' zquat='0' wquat='1' visible='0' scadavisible='1' interactive='1' solid='0' layer='1' poslock='0' comp2dType='0' >
				<resources />
				<properties />
				<values >
					<value target='GenCode' data='1' />
				</values>
				<events />
				<apis />
				<variables />
				<macros />
			</component>
		</component>
	</components>
	<scadaresourcelookup />
	<keymap />
	<panel2d shadows='0' lighting='2' brightness='0' >
		<background rgb='9737364' img='' style='0' />
		<camera xe='0' ye='0' ze='412.135' xt='0' yt='0' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<viewport dx='622' dy='352' zoom='182.615' fix_topleft='0' />
		<page x='1000' y='1000' show='0' rgb='0' />
		<winpos ID='7005' RectRecentFloat='1206,186,1856,636' RectRecentDocked='0,0,488,419' RecentFrameAlignment='16384' RecentRowIndex='0' IsFloating='1' MRUWidth='32767' PinState='0' IsMaximized='0' IsVisible='1' />
	</panel2d>
	<panel3d shadows='0' lighting='2' brightness='0' perspective='1' >
		<background rgb='8409120' img='' style='4' />
		<table rgb='7884836' img='' style='0' size='21' />
		<camera xe='0' ye='0' ze='103.713' xt='0' yt='0' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<camerakey0 xe='0' ye='0' ze='300' xt='0' yt='0' zt='0' xquat='0' yquat='0' zquat='0' wquat='1' />
		<camerakey1 xe='-3.67394e-14' ye='0' ze='-300' xt='0' yt='0' zt='0' xquat='0' yquat='1' zquat='0' wquat='6.12323e-17' />
		<camerakey2 xe='0' ye='-300' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.707107' yquat='0' zquat='0' wquat='0.707107' />
		<camerakey3 xe='-3.67394e-14' ye='300' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-4.32978e-17' yquat='0.707107' zquat='0.707107' wquat='4.32978e-17' />
		<camerakey4 xe='-300' ye='-6.66134e-14' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.5' yquat='0.5' zquat='0.5' wquat='0.5' />
		<camerakey5 xe='300' ye='-6.66134e-14' ze='6.66134e-14' xt='0' yt='0' zt='0' xquat='-0.5' yquat='-0.5' zquat='-0.5' wquat='0.5' />
		<camerakey6 xe='-173.205' ye='-173.205' ze='173.205' xt='0' yt='0' zt='0' xquat='-0.424708' yquat='0.17592' zquat='0.339851' wquat='0.820473' />
		<winpos ID='7004' RectRecentFloat='0,425,654,1002' RectRecentDocked='0,0,488,874' RecentFrameAlignment='16384' RecentRowIndex='0' IsFloating='0' MRUWidth='32767' PinState='0' IsMaximized='0' IsVisible='0' />
	</panel3d>
	<panels2d count='0' />
	<layout >
		<view type='0' name='GetResponse' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SendAndCalcCRC16' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Initialise' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='GetResponseInt' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ResetEnergy' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadAnalogInput' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Property' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_Initialise' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='GetResponseByte' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Main' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SendValueAsASCII' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='Ev_GetVarSize' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='75' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadVoltage' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadPowerFactor' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadPower' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadFrequency' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadEnergy' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadCurrent' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadAlarmStatus' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadPowerAlarmThreshold' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='ReadPowerAlarmThresh' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
		<view type='0' name='SetPowerThresholdLevel' mode='0' placement='LAAAAAAAAAABAAAA---------------------wUAAAAYAAAAzAMAAGsDAAA' zoom='100' scrollx='0' scrolly='0' flags='0' />
	</layout>
</document>
</root>
