// CRC: 876150128DE39CBB738C8B441E478605FF8619720F3C9ECA02C246EC0B5408284DD7FBE47A08ABF4FA55D2932F1B1F547D585A9035156049CC803DDC48541E52294086EC84AD0F67A25F3B95FFFA448C9A0D46BD3B6AACB92DE4D84759EBB5079CA9DA2D2BBCDAE2A4D1C56CD1580BF512848426B03DD9E2E479FE2409C0651CDE1A1F0F6E65A06B19BE5408585080FD3E35C439883AFE3ECE41C416883AFBDD9DEC7B526DBE11094A21850E2AA6E7A2BD2E0F159494632D7A8A53AB03CE34ECC0E8E7DB36F2910A549D34A0D5AD11F31ED7C39441847E882977C50D54B0629EE921658876F59D7AB68A65FD090A6D6B4C68FB27E1809948
// REVISION: 1.0
// GUID: 2167BA55-35E0-47DB-BD3D-0A4C2D97B5B6
// DATE: 08\08\2022
// DIR: CAL\LIB\libhydrogen-master\impl\kdf.h
int
hydro_kdf_derive_from_key(uint8_t *subkey, size_t subkey_len, uint64_t subkey_id,
                          const char    ctx[hydro_kdf_CONTEXTBYTES],
                          const uint8_t key[hydro_kdf_KEYBYTES])
{
    hydro_hash_state st;

    COMPILER_ASSERT(hydro_kdf_CONTEXTBYTES >= hydro_hash_CONTEXTBYTES);
    COMPILER_ASSERT(hydro_kdf_KEYBYTES >= hydro_hash_KEYBYTES);
    if (hydro_hash_init_with_tweak(&st, ctx, subkey_id, key) != 0) {
        return -1;
    }
    return hydro_hash_final(&st, subkey, subkey_len);
}

void
hydro_kdf_keygen(uint8_t key[hydro_kdf_KEYBYTES])
{
    hydro_random_buf(key, hydro_kdf_KEYBYTES);
}
